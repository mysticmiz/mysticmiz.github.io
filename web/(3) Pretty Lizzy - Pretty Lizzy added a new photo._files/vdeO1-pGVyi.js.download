if (self.CavalryLogger) { CavalryLogger.start_js(["ORK+o"]); }

__d("PagesManagerInboxNUX",[],(function(a,b,c,d,e,f){e.exports={pages_inbox_welcome_dialog:4622,page_inbox_unified_thread_list_instagram_nux:7319,page_inbox_unified_thread_list_nux:7318,bizweb_inbox_upsell_nux:7762,page_inbox_marketing_email_nux:7423,pages_smart_compose_nux:7676,page_inbox_utl_enable_messenger_nux:7320,page_inbox_instagram_direct_nux:6967,www_return_to_send_message_nux:7504,page_inbox_ig_comment_new_experience:7344,pages_comms_new_automated_responses:6645,www_pages_new_away_toggle_nux:5345,www_pages_inbox_new_folder:7376,pages_inbox_admin_assign:5144,page_comms_auto_label:6487,page_inbox_saved_reply_nux:7191,pages_inbox_bulk_actions:-1,page_inbox_saved_reply_for_ig_direct_nux:7422,page_inbox_reply_insignia_nux:7663,pages_inbox_auto_response_faq:7434,saved_responses_to_automated_responses:6862,business_inbox_ig_direct_automated_response:7538,business_inbox_product_picker_nux:7616,business_inbox_covid_automated_response:7852,business_inbox_ig_direct_multi_admin_assignment:7552,www_page_messaging_persona_entrybutton:6242,business_inbox_automated_checkout:7587,page_inbox_saved_reply_upsell_nux:7452,business_inbox_automation_done_folder:7541,pages_inbox_change_folder:4627,pages_inbox_move_folder_done:4642,www_mark_as_paid_nux:6348,www_page_inbox_order_details_nux:7798,page_inbox_instagram_direct_upsell:6773}}),null);
__d("CRMClientDetailsNote_note.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CRMClientDetailsNote_note",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"body",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null}],type:"PageAdminNote"};e.exports=a}),null);
__d("CRMClientDetailsCreateLabelMutation.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input",type:"CreateBusinessPresenceCustomLabelData!"}],b=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],concreteType:"CreateBusinessPresenceCustomLabelResponsePayload",kind:"LinkedField",name:"create_business_presence_custom_label",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label_color",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"CRMClientDetailsCreateLabelMutation",selections:b,type:"Mutation"},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"CRMClientDetailsCreateLabelMutation",selections:b},params:{id:"2270157206369625",metadata:{},name:"CRMClientDetailsCreateLabelMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("CRMClientDetailsDeleteLabelMutation.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input",type:"DeleteBusinessPresenceCustomLabelData!"}],b=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],concreteType:"DeleteBusinessPresenceCustomLabelResponsePayload",kind:"LinkedField",name:"delete_business_presence_custom_label",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"client_mutation_id",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"CRMClientDetailsDeleteLabelMutation",selections:b,type:"Mutation"},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"CRMClientDetailsDeleteLabelMutation",selections:b},params:{id:"2291802964203849",metadata:{},name:"CRMClientDetailsDeleteLabelMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("CRMClientDetailsSetLabelMutation.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input",type:"PageContactSetLabelInputData!"}],b=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],concreteType:"PageContactSetLabelResponsePayload",kind:"LinkedField",name:"page_contact_set_label",plural:!1,selections:[{alias:null,args:null,concreteType:"BusinessPresenceCustomLabel",kind:"LinkedField",name:"label",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label_color",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"CRMClientDetailsSetLabelMutation",selections:b,type:"Mutation"},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"CRMClientDetailsSetLabelMutation",selections:b},params:{id:"2328601890536423",metadata:{},name:"CRMClientDetailsSetLabelMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("CRMClientDetailsUnsetLabelMutation.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input",type:"PageContactUnsetLabelInputData!"}],b=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],concreteType:"PageContactUnsetLabelResponsePayload",kind:"LinkedField",name:"page_contact_unset_label",plural:!1,selections:[{alias:null,args:null,concreteType:"PageContact",kind:"LinkedField",name:"page_contact",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"CRMClientDetailsUnsetLabelMutation",selections:b,type:"Mutation"},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"CRMClientDetailsUnsetLabelMutation",selections:b},params:{id:"1970946266349250",metadata:{},name:"CRMClientDetailsUnsetLabelMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("CRMClientDetailsUpdateLabelColorMutation.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input",type:"UpdateColorBusinessPresenceCustomLabelData!"}],b=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],concreteType:"UpdateColorBusinessPresenceCustomLabelResponsePayload",kind:"LinkedField",name:"update_color_business_presence_custom_label",plural:!1,selections:[{alias:null,args:null,concreteType:"BusinessPresenceCustomLabel",kind:"LinkedField",name:"business_presence_custom_label",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label_color",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"CRMClientDetailsUpdateLabelColorMutation",selections:b,type:"Mutation"},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"CRMClientDetailsUpdateLabelColorMutation",selections:b},params:{id:"2160059580757895",metadata:{},name:"CRMClientDetailsUpdateLabelColorMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("PagesApplySavedResponseMutation.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input",type:"PageSavedResponseApplyData!"}],b=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],concreteType:"PageSavedResponseApplyResponsePayload",kind:"LinkedField",name:"page_saved_response_apply",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"applied_saved_response_id",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"PagesApplySavedResponseMutation",selections:b,type:"Mutation"},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"PagesApplySavedResponseMutation",selections:b},params:{id:"1729099447192411",metadata:{},name:"PagesApplySavedResponseMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("SavedResponsesUtilsAutomatedCheckoutQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"pageID",type:"ID!"}],b=[{kind:"Variable",name:"id",variableName:"pageID"}],c={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},d={alias:null,args:null,concreteType:"AutomatedResponseSettings",kind:"LinkedField",name:"automated_responses_settings",plural:!1,selections:[{alias:null,args:null,concreteType:"PageAutomationSettingsPayload",kind:"LinkedField",name:"eligible_automations",plural:!0,selections:[c,{alias:null,args:null,kind:"ScalarField",name:"trigger",storageKey:null}],storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"SavedResponsesUtilsAutomatedCheckoutQuery",selections:[{alias:null,args:b,concreteType:"Page",kind:"LinkedField",name:"page",plural:!1,selections:[d],storageKey:null}],type:"Query"},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"SavedResponsesUtilsAutomatedCheckoutQuery",selections:[{alias:null,args:b,concreteType:"Page",kind:"LinkedField",name:"page",plural:!1,selections:[d,c],storageKey:null}]},params:{id:"2308404809281721",metadata:{},name:"SavedResponsesUtilsAutomatedCheckoutQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("SavedResponsesUtilsSavedResponseQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"pageID",type:"ID!"}],b=[{kind:"Variable",name:"id",variableName:"pageID"}],c={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"response_title",storageKey:null},e={alias:null,args:null,kind:"ScalarField",name:"response_message",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"filename",storageKey:null},g={alias:null,args:null,concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"mime_type",storageKey:null}],storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"usage_count",storageKey:null},j={alias:null,args:null,kind:"ScalarField",name:"last_time_used",storageKey:null};return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"SavedResponsesUtilsSavedResponseQuery",selections:[{alias:null,args:b,concreteType:"Page",kind:"LinkedField",name:"page",plural:!1,selections:[{alias:null,args:null,concreteType:"PageAdminInfo",kind:"LinkedField",name:"admin_info",plural:!1,selections:[{alias:null,args:null,concreteType:"PageToSavedResponsesConnection",kind:"LinkedField",name:"saved_responses",plural:!1,selections:[{alias:null,args:null,concreteType:"PageToSavedResponsesEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"PageSavedResponse",kind:"LinkedField",name:"node",plural:!1,selections:[c,d,e,{alias:null,args:null,concreteType:"MessageImage",kind:"LinkedField",name:"response_image",plural:!1,selections:[f,g,h],storageKey:null},i,j],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Query"},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"SavedResponsesUtilsSavedResponseQuery",selections:[{alias:null,args:b,concreteType:"Page",kind:"LinkedField",name:"page",plural:!1,selections:[{alias:null,args:null,concreteType:"PageAdminInfo",kind:"LinkedField",name:"admin_info",plural:!1,selections:[{alias:null,args:null,concreteType:"PageToSavedResponsesConnection",kind:"LinkedField",name:"saved_responses",plural:!1,selections:[{alias:null,args:null,concreteType:"PageToSavedResponsesEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"PageSavedResponse",kind:"LinkedField",name:"node",plural:!1,selections:[c,d,e,{alias:null,args:null,concreteType:"MessageImage",kind:"LinkedField",name:"response_image",plural:!1,selections:[f,g,h,c],storageKey:null},i,j],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},c],storageKey:null}]},params:{id:"2770631893010664",metadata:{},name:"SavedResponsesUtilsSavedResponseQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("SavedResponsesUtilsTokenQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"pageID",type:"ID!"},{defaultValue:null,kind:"LocalArgument",name:"userID",type:"ID"},{defaultValue:null,kind:"LocalArgument",name:"threadID",type:"ID"},{defaultValue:null,kind:"LocalArgument",name:"platform",type:"PageCommPlatform"}],b=[{kind:"Variable",name:"id",variableName:"pageID"}],c={alias:null,args:null,concreteType:"PageAdminInfo",kind:"LinkedField",name:"admin_info",plural:!1,selections:[{alias:null,args:[{kind:"Variable",name:"platform",variableName:"platform"},{kind:"Variable",name:"with_thread",variableName:"threadID"},{kind:"Variable",name:"with_user",variableName:"userID"}],concreteType:"PageToSavedResponseMacrosConnection",kind:"LinkedField",name:"saved_response_macros",plural:!1,selections:[{alias:null,args:null,concreteType:"PageToSavedResponseMacrosEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"PageSavedResponseMacro",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"instagram_description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"example",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"SavedResponsesUtilsTokenQuery",selections:[{alias:null,args:b,concreteType:"Page",kind:"LinkedField",name:"page",plural:!1,selections:[c],storageKey:null}],type:"Query"},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"SavedResponsesUtilsTokenQuery",selections:[{alias:null,args:b,concreteType:"Page",kind:"LinkedField",name:"page",plural:!1,selections:[c,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{id:"2021967994572804",metadata:{},name:"SavedResponsesUtilsTokenQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("IGMessageDataDispatcher",["ExplicitRegistrationReactDispatcher"],(function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(b("ExplicitRegistrationReactDispatcher"));e.exports=new a({strict:!0})}),null);
__d("IGMessageDataMutateActionTypes",["keyMirror"],(function(a,b,c,d,e,f){"use strict";e.exports=b("keyMirror")({FORCE_FETCH:"",CREATING:"",CREATE:"",UPDATING:"",UPDATE:"",DELETING:"",DELETE:""})}),null);
__d("InstagramMessageGraphQLThreadItemFetcher",["Promise","BanzaiODS","InstagramMessageThreadItemWebGraphQLQuery","WebGraphQL","promiseDone"],(function(a,b,c,d,e,f){"use strict";e.exports={fetch:function(a,c){return new(b("Promise"))(function(d,e){b("promiseDone")(b("WebGraphQL").exec(new(b("InstagramMessageThreadItemWebGraphQLQuery"))(c),{actorID:a,batchName:"InstagramMessageGraphQLThreadItemFetcher"}),function(a){b("BanzaiODS").bumpEntityKey(2966,"Instagram_message_webgraphql","InstagramMessageGraphQLThreadItemFetcher.success"),d(a)},function(a){a=a.errors;b("BanzaiODS").bumpEntityKey(2966,"Instagram_message_webgraphql","InstagramMessageGraphQLThreadItemFetcher.failure");e(a)})})}}}),null);
__d("InstagramMessageGraphQLThreadItemsFetcher",["Promise","BanzaiODS","InstagramMessageThreadItemsWebGraphQLQuery","WebGraphQL","promiseDone"],(function(a,b,c,d,e,f){"use strict";e.exports={fetch:function(a,c){return new(b("Promise"))(function(d,e){b("promiseDone")(b("WebGraphQL").exec(new(b("InstagramMessageThreadItemsWebGraphQLQuery"))(c),{actorID:a,batchName:"InstagramMessageGraphQLThreadItemsFetcher"}),function(a){b("BanzaiODS").bumpEntityKey(2966,"instagram_message_webgraphql","InstagramMessageGraphQLThreadItemsFetcher.success"),d(a)},function(a){a=a.errors;b("BanzaiODS").bumpEntityKey(2966,"instagram_message_webgraphql","InstagramMessageGraphQLThreadItemsFetcher.failure");e(a)})})},fetchFromUser:function(a){return new(b("Promise"))(function(c,d){b("promiseDone")(b("WebGraphQL").exec(new(b("InstagramMessageThreadItemsWebGraphQLQuery"))(a)),function(a){b("BanzaiODS").bumpEntityKey(2966,"instagram_message_webgraphql","InstagramMessageGraphQLThreadItemsFetcher.success"),c(a)},function(a){a=a.errors;b("BanzaiODS").bumpEntityKey(2966,"instagram_message_webgraphql","InstagramMessageGraphQLThreadItemsFetcher.failure");d(a)})})}}}),null);
__d("InstagramMessageGraphQLThreadsFetcher",["Promise","BanzaiODS","InstagramBusinessMessageInboxQueryWebGraphQLQuery","InstagramMessageThreadsWebGraphQLQuery","WebGraphQL","promiseDone"],(function(a,b,c,d,e,f){"use strict";e.exports={fetch:function(a,c){return new(b("Promise"))(function(d,e){b("promiseDone")(b("WebGraphQL").exec(new(b("InstagramMessageThreadsWebGraphQLQuery"))(c),{actorID:a,batchName:"InstagramMessageGraphQLThreadsFetcher"}),function(a){b("BanzaiODS").bumpEntityKey(2966,"instagram_message_webgraphql","InstagramMessageGraphQLThreadsFetcher.success"),d(a)},function(a){a=a.errors;b("BanzaiODS").bumpEntityKey(2966,"instagram_message_webgraphql","InstagramMessageGraphQLThreadsFetcher.failure");e(a)})})},fetchFromUser:function(a,c){return new(b("Promise"))(function(d,e){b("promiseDone")(b("WebGraphQL").exec(new(b("InstagramBusinessMessageInboxQueryWebGraphQLQuery"))({inbox_id:a,limit:c.limit,after:c.after,folder:c.folder,is_follow_up:c.is_follow_up,is_unread:c.is_unread,loadThreads:c.loadThreads,assigned_admin_id:c.assigned_admin_id})),function(a){var c;b("BanzaiODS").bumpEntityKey(2966,"instagram_message_webgraphql","InstagramDirectMessageGraphQLThreadsFetcher.success");d({viewer:{instagram_message_threads:{sync_sequence_id:(c=a.instagram_business_message_inbox)==null?void 0:c.sync_sequence_id,unseen_count:(c=a.instagram_business_message_inbox)==null?void 0:c.unseen_count,nodes:(c=a.instagram_business_message_inbox)==null?void 0:(a=c.instagram_direct_message_threads)==null?void 0:a.nodes,ig_user:{instagram_user_id:"",profile_picture:{uri:""}}}}})},function(a){a=a.errors;b("BanzaiODS").bumpEntityKey(2966,"instagram_message_webgraphql","InstagramDirectMessageGraphQLThreadsFetcher.failure");e(a)})})}}}),null);
__d("IGMessageInboxStore",["invariant","FBLogger","FluxLoadObjectStore","IGMessageDataDispatcher","IGMessageDataMutateActionTypes","InstagramMessageGraphQLThreadItemFetcher","InstagramMessageGraphQLThreadItemsFetcher","InstagramMessageGraphQLThreadsFetcher","LoadObject","PagesManagerInboxUnifiedThreadlistAction","immutable","keyMirror","nullthrows"],(function(a,b,c,d,e,f,g){"use strict";var h="1",i="IGMessageID",j={INBOX:"INBOX",THREAD:"THREAD",ITEM:"ITEM"},k=b("keyMirror")({LOADED:""});a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.$IGMessageInboxStore1=new Map(),c.$IGMessageInboxStore2=new Map(),c.$IGMessageInboxStore3=!0,c.$IGMessageInboxStore4=null,c.$IGMessageInboxStore5=null,c.$IGMessageInboxStore6=null,c.$IGMessageInboxStore7=null,c.$IGMessageInboxStore8=void 0,c.$IGMessageInboxStore9=void 0,c.$IGMessageInboxStore10=null,b)||babelHelpers.assertThisInitialized(c)}var d=c.prototype;d.getItemToken=function(a,b,c){a=[h,i,a,b,c];return a.join(":")};d.getInboxFromUser=function(a,b,c,d,e,f,g){return this.getInbox(a,b,c,d,e,f,g,!0)};d.getInbox=function(a,c,d,e,f,h,i,k){var l,m;k===void 0&&(k=!1);if(!a){b("PagesManagerInboxUnifiedThreadlistAction").setInstagramInbox(null);return b("LoadObject").empty()}this.$IGMessageInboxStore3===!1&&b("PagesManagerInboxUnifiedThreadlistAction").setIsLoadingInbox(!1);l=(l=c)!=null?l:1;l>=1||g(0,11872);var n=this.$IGMessageInboxStore11({type:j.INBOX,inboxID:a,limit:l,cursor:d,folder:e,is_follow_up:f,is_unread:h,assigned_admin_id:i,fetch_from_user:k});this.$IGMessageInboxStore5=a;this.$IGMessageInboxStore6=c;this.$IGMessageInboxStore7=e;this.$IGMessageInboxStore8=f;this.$IGMessageInboxStore9=h;c=this.get(n);if(c.isDeleting()){b("PagesManagerInboxUnifiedThreadlistAction").setInstagramInbox(null);return b("LoadObject").deleting()}else if(!c.hasValue()){if(c.hasError()){b("FBLogger")("pages_messaging_www").mustfix("Encounter error when loading IG inbox: %s",a);this.$IGMessageInboxStore12(this.$IGMessageInboxStore11({type:j.INBOX,inboxID:a,limit:l,folder:e,is_follow_up:f,is_unread:h,assigned_admin_id:i,fetch_from_user:k}));b("PagesManagerInboxUnifiedThreadlistAction").setInstagramInbox(null);b("PagesManagerInboxUnifiedThreadlistAction").setInstagramLoadingError(!0);return b("LoadObject").loading().setError(c.getError())}d&&g(0,3361);b("PagesManagerInboxUnifiedThreadlistAction").setInstagramInbox(null);return b("LoadObject").loading()}m=(m=c.value)!=null?m:{};m=m.inbox;if(m===null||m===void 0){b("PagesManagerInboxUnifiedThreadlistAction").setInstagramInbox(null);return b("LoadObject").withValue(null)}var o=this.$IGMessageInboxStore1.get(n);if(o&&o.stateData.inbox===m){o.isLoading!==c.isLoading()&&(o={stateData:b("nullthrows")(c.value),returnedData:o.returnedData,isLoading:c.isLoading(),error:c.getError()},this.$IGMessageInboxStore1.set(n,o));if(o.isLoading){b("PagesManagerInboxUnifiedThreadlistAction").setInstagramInbox(o.returnedData.inbox);return b("LoadObject").withValue(o.returnedData.inbox).loading().setError(o.error)}else if(!(o.error instanceof Error)){b("PagesManagerInboxUnifiedThreadlistAction").setInstagramInbox(o.returnedData.inbox);return b("LoadObject").withValue(o.returnedData.inbox)}}o=(o=m.nodes)!=null?o:[];var p=0;if(d!==null&&d!==void 0){var q=-1;for(var r=o.length-1;r>=0;r--)if(o[r].token===d.lastEntityToken){q=r;break}else if(this.largeNumberCompare(d.lastEntityTime,b("nullthrows")(o[r].last_activity_at))===-1)break;if(q===-1){b("PagesManagerInboxUnifiedThreadlistAction").setInstagramInbox(null);return b("LoadObject").withValue(null)}p=q+1}d=Object.assign({},m);r=!1;if(p+l<=o.length)d.nodes=o.slice(p,p+l),d.page_info={has_next_page:p+l<o.length||m.page_info&&m.page_info.has_next_page};else if(!m.page_info&&!m.nodes)this.$IGMessageInboxStore12(this.$IGMessageInboxStore11({type:j.INBOX,inboxID:a,limit:l,folder:e,is_follow_up:f,is_unread:h,assigned_admin_id:i,fetch_from_user:k})),r=!0;else if(!m.page_info||!b("nullthrows")(m.page_info).has_next_page)d.nodes=o.slice(p,o.length),d.page_info={has_next_page:!1};else{q=null;o.length>0&&(q={lastEntityTime:b("nullthrows")(o[o.length-1].last_activity_at),lastEntityToken:b("nullthrows")(o[o.length-1].token)});this.$IGMessageInboxStore12(this.$IGMessageInboxStore11({type:j.INBOX,inboxID:a,limit:p+l-o.length,cursor:q,folder:e,is_follow_up:f,is_unread:h,assigned_admin_id:i,graphqlCursor:b("nullthrows")(m.page_info).end_cursor,fetch_from_user:k}));d.nodes=o.slice(p,o.length);d.page_info={has_next_page:!0};r=!0}this.$IGMessageInboxStore1.set(n,{stateData:b("nullthrows")(c.value),returnedData:{inbox:d},isLoading:r,error:c.getError()});if(r){b("PagesManagerInboxUnifiedThreadlistAction").setInstagramInbox(d);return b("LoadObject").withValue(d).loading().setError(c.getError())}else{b("PagesManagerInboxUnifiedThreadlistAction").setInstagramInbox(d);return b("LoadObject").withValue(d).setError(c.getError())}};d.getThreadFromUser=function(a,b,c,d){return this.getThread(a,b,c,d,!0)};d.getThread=function(a,c,d,e,f){var h,i;f===void 0&&(f=!1);if(c===""||!a)return b("LoadObject").empty();d=(d=d)!=null?d:1;d>=1||g(0,11872);var k=this.$IGMessageInboxStore11({type:j.THREAD,inboxID:a,token:c,limit:d,cursor:e,fetch_from_user:f}),l=this.get(k);if(l.isDeleting())return b("LoadObject").deleting();else if(!l.hasValue()){if(l.hasError()){b("FBLogger")("pages_messaging_www").mustfix("Encounter error when loading IG thread: %s, $s",a,c);return b("LoadObject").empty().setError(l.getError())}e&&g(0,3361);return b("LoadObject").loading()}h=(h=l.value)!=null?h:{};h=h.thread;if(h===null||h===void 0)return b("LoadObject").withValue(null);var m=this.$IGMessageInboxStore1.get(k);if(m&&m.stateData.thread===h){m.isLoading!==l.isLoading()&&(m={stateData:b("nullthrows")(l.value),returnedData:m.returnedData,isLoading:l.isLoading(),error:l.getError()},this.$IGMessageInboxStore1.set(k,m));if(m.isLoading)return b("LoadObject").withValue(m.returnedData.thread).loading().setError(m.error);else if(!(m.error instanceof Error))return b("LoadObject").withValue(m.returnedData.thread)}m=(m=h.thread_items)!=null?m:{};i=(i=m.nodes)!=null?i:[];var n=0;if(e!==null&&e!==void 0){var o=-1;for(var p=i.length-1;p>=0;p--)if(i[p].token===e.lastEntityToken){o=p;break}else if(this.largeNumberCompare(e.lastEntityTime,b("nullthrows")(i[p].time_stamp))===-1)break;if(o===-1)return b("LoadObject").withValue(null);n=o+1}e=Object.assign({},h);p=Object.assign({},m);o=!1;e.thread_items=p;if(n+d<=i.length)p.nodes=i.slice(n,n+d),p.page_info={has_next_page:n+d<i.length||m.page_info&&m.page_info.has_next_page};else if(!m.page_info&&!m.nodes)this.$IGMessageInboxStore12(this.$IGMessageInboxStore11({type:j.THREAD,inboxID:a,token:c,limit:d,fetch_from_user:f})),o=!0;else if(!m.page_info||!b("nullthrows")(m.page_info).has_next_page)p.nodes=i.slice(n,i.length),p.page_info={has_next_page:!1};else{h=null;i.length>0&&(h={lastEntityTime:b("nullthrows")(i[i.length-1].time_stamp),lastEntityToken:b("nullthrows")(i[i.length-1].token)});this.$IGMessageInboxStore12(this.$IGMessageInboxStore11({type:j.THREAD,inboxID:b("nullthrows")(a),token:c,limit:n+d-i.length,cursor:h,graphqlCursor:b("nullthrows")(m.page_info).end_cursor,fetch_from_user:f}));p.nodes=i.slice(n,i.length);p.page_info={has_next_page:!0};o=!0}this.$IGMessageInboxStore1.set(k,{stateData:b("nullthrows")(l.value),returnedData:{thread:e},isLoading:o,error:l.getError()});if(o)return b("LoadObject").withValue(e).loading().setError(l.getError());else return b("LoadObject").withValue(e).setError(l.getError())};d.getThreadItem=function(a,c){if(!a||c==="")return b("LoadObject").empty();a=this.get(this.$IGMessageInboxStore11({type:j.ITEM,inboxID:a,token:c}));if(a.isDeleting())return b("LoadObject").deleting();else if(!a.hasValue())return b("LoadObject").loading();else if(a.isCreating())return b("LoadObject").withValue(a.getValueEnforcing().item).creating();return b("LoadObject").withValue(a.getValueEnforcing().item)};d.__load=function(a){a=this.$IGMessageInboxStore13(a);switch(a.type){case j.INBOX:this.$IGMessageInboxStore14(a);break;case j.THREAD:this.$IGMessageInboxStore15(a);break;case j.ITEM:this.$IGMessageInboxStore16(a);break}};d.$IGMessageInboxStore14=function(a){Boolean(a.fetch_from_user)?b("InstagramMessageGraphQLThreadsFetcher").fetchFromUser(a.inboxID,{limit:a.limit,folder:a.folder,is_follow_up:a.is_follow_up,is_unread:a.is_unread,assigned_admin_id:a.assigned_admin_id,after:a.graphqlCursor,loadThreads:!0}).then(function(c){b("IGMessageDataDispatcher").dispatch({request:a,payload:{inbox:c},type:k.LOADED})})["catch"](function(c){b("IGMessageDataDispatcher").dispatch({request:a,payload:new Error(c),type:k.LOADED})}):b("InstagramMessageGraphQLThreadsFetcher").fetch(a.inboxID,{limit:a.limit,folder:a.folder,is_follow_up:a.is_follow_up,is_unread:a.is_unread,assigned_admin_id:a.assigned_admin_id,after:a.graphqlCursor,loadThreads:!0}).then(function(c){b("IGMessageDataDispatcher").dispatch({request:a,payload:{inbox:c},type:k.LOADED})})["catch"](function(c){b("IGMessageDataDispatcher").dispatch({request:a,payload:new Error(c),type:k.LOADED})})};d.$IGMessageInboxStore15=function(a){Boolean(a.fetch_from_user)?b("InstagramMessageGraphQLThreadItemsFetcher").fetchFromUser({token:b("nullthrows")(a.token),instagram_user_id:a.inboxID,item_limit:a.limit,item_after:a.graphqlCursor,load_items:!0,width:480,height:480}).then(function(c){c.instagram_message_thread===null?b("IGMessageDataDispatcher").dispatch({request:a,payload:new Error("Failed to fetch thread"),type:k.LOADED}):b("IGMessageDataDispatcher").dispatch({request:a,payload:{thread:c},type:k.LOADED})})["catch"](function(c){b("IGMessageDataDispatcher").dispatch({request:a,payload:new Error(c),type:k.LOADED})}):b("InstagramMessageGraphQLThreadItemsFetcher").fetch(a.inboxID,{token:b("nullthrows")(a.token),item_limit:a.limit,item_after:a.graphqlCursor,load_items:!0,width:480,height:480}).then(function(c){c.instagram_message_thread===null?b("IGMessageDataDispatcher").dispatch({request:a,payload:new Error("Failed to fetch thread"),type:k.LOADED}):b("IGMessageDataDispatcher").dispatch({request:a,payload:{thread:c},type:k.LOADED})})["catch"](function(c){b("IGMessageDataDispatcher").dispatch({request:a,payload:new Error(c),type:k.LOADED})})};d.$IGMessageInboxStore16=function(a){b("InstagramMessageGraphQLThreadItemFetcher").fetch(a.inboxID,{token:b("nullthrows")(a.token),width:480,height:480}).then(function(c){b("IGMessageDataDispatcher").dispatch({request:a,payload:{item:c},type:k.LOADED})})["catch"](function(c){b("IGMessageDataDispatcher").dispatch({request:a,payload:new Error(c),type:k.LOADED})})};d.__getActionTypes=function(){var a;return[this.getActionTypeStartLoad(),k.LOADED,(a=b("IGMessageDataMutateActionTypes")).CREATE,a.CREATING,a.DELETE,a.DELETING,a.FORCE_FETCH,a.UPDATE]};d.reduce=function(a,c){var d;switch(c.type){case k.LOADED:var e=c.payload;this.$IGMessageInboxStore2.set(this.$IGMessageInboxStore11(c.request),!1);if(e instanceof Error)return this.$IGMessageInboxStore17(a,c.request,e);switch(c.request.type){case j.INBOX:this.$IGMessageInboxStore3=!1;b("PagesManagerInboxUnifiedThreadlistAction").setIsLoadingInbox(!1);return this.$IGMessageInboxStore18(a,c.request,b("nullthrows")(e.inbox));case j.THREAD:return this.$IGMessageInboxStore19(a,c.request,b("nullthrows")(e.thread));case j.ITEM:return this.$IGMessageInboxStore20(a,c.request,b("nullthrows")(e.item))}return a;case b("IGMessageDataMutateActionTypes").FORCE_FETCH:switch(c.request.type){case j.INBOX:b("PagesManagerInboxUnifiedThreadlistAction").setIsLoadingInbox(!0),this.$IGMessageInboxStore3=!0}this.$IGMessageInboxStore12(this.$IGMessageInboxStore11(c.request));return a;case b("IGMessageDataMutateActionTypes").DELETING:return this.__setDeleting(a,b("immutable").List.of(this.$IGMessageInboxStore21(c.request)));case b("IGMessageDataMutateActionTypes").DELETE:e=a;switch(c.request.type){case j.THREAD:e=this.$IGMessageInboxStore22(a,c.request.inboxID,b("nullthrows")(c.request.token));break;case j.ITEM:e=this.$IGMessageInboxStore23(a,c.request.inboxID,b("nullthrows")((d=c)!=null?(d=d.extraData)!=null?d.threadToken:d:d),b("nullthrows")(c.request.token));break}return this.__setEmpty(e,b("immutable").List.of(this.$IGMessageInboxStore21(c.request)));case b("IGMessageDataMutateActionTypes").CREATING:if(c.request.type===j.ITEM){var f,g,h;e=b("nullthrows")((d=c)!=null?(d=d.payload)!=null?d.item:d:d);d=b("nullthrows")(e.client_context);e=Object.assign({},e,{token:d});h=b("nullthrows")((h=c)!=null?(h=h.extraData)!=null?h.threadToken:h:h);var i=this.$IGMessageInboxStore24(a,c.request.inboxID,h,null,e),l=this.$IGMessageInboxStore21({type:j.THREAD,inboxID:c.request.inboxID,token:h}),m=this.$IGMessageInboxStore25(i,l);m=(m=m)!=null?(m=m.value)!=null?m.thread:m:m;g=((g=e)!=null?g.time_stamp:g)||this.getNowTimestamp();f=(f=(f=m)!=null?f.last_activity_at:f)!=null?f:g;i=this.$IGMessageInboxStore26(i,c.request.inboxID,h,{token:h,last_activity_at:f},0);var n=this.getInboxIGID();h=(((h=m)!=null?h.last_seen_at:h)||[]).find(function(a){return a.user_id==n});if(this.largeNumberCompare(((h=h)!=null?h.timestamp:h)||"0",g)==-1){g=(((h=m)!=null?h.last_seen_at:h)||[]).filter(function(a){return a.user_id!==n});g.push({item_id:d,timestamp:e.time_stamp,user_id:n});h=Object.assign({},m,{last_seen_at:g,last_activity_at:f});i=this.$IGMessageInboxStore27(i,l,{thread:h})}return i.set(this.$IGMessageInboxStore21({type:j.ITEM,inboxID:c.request.inboxID,token:d}),b("LoadObject").withValue({item:e}).creating())}return a;case b("IGMessageDataMutateActionTypes").CREATE:switch(c.request.type){case j.THREAD:g=b("nullthrows")((m=c)!=null?(m=m.payload)!=null?m.thread:m:m);f=this.$IGMessageInboxStore26(a,c.request.inboxID,null,{token:b("nullthrows")(g.token),last_activity_at:b("nullthrows")(g.last_activity_at)},0);i=(h=(l=g)!=null?(l=l.thread_items)!=null?l.nodes:l:l)!=null?h:[];d=i.map(function(a){return{token:a.token,time_stamp:a.time_stamp}});e=Object.assign({},g.thread_items,{nodes:d});m=Object.assign({},g,{thread_items:e});return this.$IGMessageInboxStore27(f,this.$IGMessageInboxStore21({type:j.THREAD,inboxID:c.request.inboxID,token:b("nullthrows")(g.token)}),{thread:m});case j.ITEM:h=b("nullthrows")((l=c)!=null?(l=l.payload)!=null?l.item:l:l);i=this.$IGMessageInboxStore21({type:j.ITEM,inboxID:c.request.inboxID,token:b("nullthrows")(h.token)});if(!this.$IGMessageInboxStore25(a,i).isEmpty())return a;e=b("nullthrows")((d=c)!=null?(d=d.extraData)!=null?d.threadToken:d:d);f=this.$IGMessageInboxStore24(a,c.request.inboxID,e,h.client_context,h);g=this.$IGMessageInboxStore21({type:j.THREAD,inboxID:c.request.inboxID,token:e});m=this.$IGMessageInboxStore25(f,g);i=(l=m)!=null?(l=l.value)!=null?l.thread:l:l;m=(f=(d=i)!=null?d.last_activity_at:d)!=null?f:h.time_stamp;l=0;d=a;if(i!==null&&i!==void 0){var o=this.getInboxIGID();f=(((f=i)!=null?f.last_seen_at:f)||[]).find(function(a){return a.user_id==o});var p={};if(f!==null&&f!==void 0&&(f.item_id===h.client_context||h.sender_id===o)){f=(((f=i)!=null?f.last_seen_at:f)||[]).filter(function(a){return a.user_id!==o});f.push({item_id:h.token,timestamp:h.time_stamp,user_id:o});p.last_seen_at=f}if(h.ig_item_type==="raven_media"&&h.sender_id!==o){f=(f=(f=i)!=null?(f=f.direct_story)!=null?f.unseen_count:f:f)!=null?f:0;p.direct_story={unseen_count:f+1,media_type:(f=h)!=null?(f=f.raven_media)!=null?f.media_type:f:f}}p.last_activity_at=h.sender_id!==this.getInboxIGID()?h.time_stamp:(f=(f=i)!=null?f.last_activity_at:f)!=null?f:h.time_stamp;f=Object.assign({},i,p);if(h.sender_id!==this.getInboxIGID()){p=(i=this.$IGMessageInboxStore25(a,g))!=null?(i=i.value)!=null?i.thread:i:i;l=this.getUnseenCountDelta(c.request.inboxID,p,f)}d=this.$IGMessageInboxStore27(d,g,{thread:f})}else h.sender_id!==this.getInboxIGID()&&(l=1);d=this.$IGMessageInboxStore26(d,c.request.inboxID,e,{token:e,last_activity_at:m},l);return this.$IGMessageInboxStore28(d,c.request.inboxID,h.client_context,h)}return a;case b("IGMessageDataMutateActionTypes").UPDATE:switch(c.request.type){case j.INBOX:p=b("nullthrows")((i=c)!=null?(i=i.payload)!=null?i.inbox:i:i);g=this.$IGMessageInboxStore21(c.request);f=this.$IGMessageInboxStore25(a,g);m=(e=f)!=null?(e=e.value)!=null?e.inbox:e:e;if(m===null||m===void 0)return a;l=Object.assign({},m,p);return this.$IGMessageInboxStore27(a,g,{inbox:l});case j.THREAD:h=b("nullthrows")((d=c)!=null?(d=d.payload)!=null?d.thread:d:d);i=this.$IGMessageInboxStore21(c.request);f=this.$IGMessageInboxStore25(a,i);m=(e=f)!=null?(e=e.value)!=null?e.thread:e:e;if(m===null||m===void 0)return a;p=Object.assign({},m,h);var q=h.last_seen_at||[];if(q.length>0){var r=q.slice();(m.last_seen_at||[]).map(function(a){q.find(function(b){return b.user_id===a.user_id})||r.push(a)});p.last_seen_at=r}else p.last_seen_at=m.last_seen_at;p.is_read=(l=(g=c.payload.thread)==null?void 0:g.is_read)!=null?l:m.is_read;d=this.$IGMessageInboxStore27(a,i,{thread:p});f=this.getUnseenCountDelta(c.request.inboxID,m,p);if(f!==0){e=this.$IGMessageInboxStore21({type:j.INBOX,inboxID:c.request.inboxID});g=(h=this.$IGMessageInboxStore25(d,e))!=null?(h=h.value)!=null?h.inbox:h:h;i=(l=g==null?void 0:g.unseen_count)!=null?l:0;m=Object.assign({},g,{unseen_count:i+f});return this.$IGMessageInboxStore27(d,e,{inbox:m})}return d;case j.ITEM:h=b("nullthrows")((p=c)!=null?(p=p.payload)!=null?p.item:p:p);l=this.$IGMessageInboxStore21(c.request);g=this.$IGMessageInboxStore25(a,l);f=(i=g)!=null?(i=i.value)!=null?i.item:i:i;if(f===null||f===void 0)return a;e=Object.assign({},f,h);if(e.time_stamp===f.time_stamp&&e.raven_media===f.raven_media)return this.$IGMessageInboxStore27(a,l,{item:e});d=b("nullthrows")((m=c)!=null?(m=m.extraData)!=null?m.threadToken:m:m);p=this.$IGMessageInboxStore24(a,c.request.inboxID,d,e.token,e,f);g=this.$IGMessageInboxStore25(a,this.$IGMessageInboxStore21({type:j.THREAD,inboxID:c.request.inboxID,token:d})).getValue();i=this.$IGMessageInboxStore25(p,this.$IGMessageInboxStore21({type:j.THREAD,inboxID:c.request.inboxID,token:d})).getValue();m=(h=i)!=null?(h=h.thread)!=null?h.last_activity_at:h:h;f=this.getUnseenCountDelta(c.request.inboxID,g==null?void 0:g.thread,i==null?void 0:i.thread);h=this.$IGMessageInboxStore26(p,c.request.inboxID,d,{token:d,last_activity_at:m},f);return this.$IGMessageInboxStore27(h,l,{item:e})}return a;default:return a}};d.$IGMessageInboxStore18=function(a,c,d){var e=this;d=(d=d.viewer)!=null?d:{};d=d.instagram_message_threads;if(!d)return this.$IGMessageInboxStore17(a,c,{inbox:null});var f=Object.assign({},d),g=a,h=d.nodes;if(h){var i=new Map(),k=c.cursor;if(!k)f.nodes=h.filter(function(a){return a.token!==null&&a.token!==void 0}).map(function(d){var a=b("nullthrows")(d.token);a=e.$IGMessageInboxStore11({type:j.THREAD,inboxID:c.inboxID,token:a});i.set(a,{thread:Object.assign({},d)});return{token:d.token,last_activity_at:d.last_activity_at}});else{var l,m,n;m=(m=this.$IGMessageInboxStore25(a,this.$IGMessageInboxStore21(c)).value)!=null?m:{};m=(m=m.inbox)!=null?m:{};n=(n=m.nodes)!=null?n:[];var o=-1;if(b("nullthrows")(c.graphqlCursor)===((l=m)!=null?(l=l.page_info)!=null?l.end_cursor:l:l))o=n.length-1;else for(var l=n.length-1;l>=0;l--){var p=this.largeNumberCompare(k.lastEntityTime,b("nullthrows")(n[l].last_activity_at));if(p===0){o=l;break}else if(p===-1)break}if(o===-1)return a;p=o+1;k=0;l=m.page_info;o=n.slice(0,p);while(k<h.length&&p<n.length){m=h[k];var q=m.token;if(q===null||q===void 0){k++;continue}var r=n[p];q===r.token?(o.push(r),p++,k++):this.largeNumberCompare(b("nullthrows")(r.last_activity_at),b("nullthrows")(m.last_activity_at))===1?p++:k++}if(k<h.length){l=d.page_info;while(k<h.length){q=h[k];r=q.token;if(r===null||r===void 0){k++;continue}m=this.$IGMessageInboxStore11({type:j.THREAD,inboxID:c.inboxID,token:r});p=this.$IGMessageInboxStore25(a,m);p.hasValue()||i.set(m,{thread:Object.assign({},q)});o.push({token:q.token,last_activity_at:q.last_activity_at});k++}}f=Object.assign({},d,{nodes:o,page_info:l})}g=this.__handleMap(a,i)}return this.$IGMessageInboxStore17(g,c,{inbox:f})};d.$IGMessageInboxStore19=function(a,c,d){var e=this;d=d.instagram_message_thread;if(!d)return this.$IGMessageInboxStore17(a,c,{thread:null});var f=Object.assign({},d),g=this.$IGMessageInboxStore21({type:j.THREAD,inboxID:c.inboxID,token:c.token});g=(g=this.$IGMessageInboxStore25(a,g))!=null?(g=g.value)!=null?g.thread:g:g;g&&(f.is_read=g.is_read);g=a;d=d.thread_items;if(d){var h=Object.assign({},d),i=new Map(),k=c.cursor;if(!k)h.nodes=d.nodes.map(function(d){var b=d.token;if(b!==null&&b!==void 0){b=e.$IGMessageInboxStore11({type:j.ITEM,inboxID:c.inboxID,token:b});var f=e.$IGMessageInboxStore25(a,b);f.hasValue()||i.set(b,{item:Object.assign({},d)})}return{token:d.token,time_stamp:d.time_stamp}});else{var l,m,n;m=(m=this.$IGMessageInboxStore25(a,this.$IGMessageInboxStore21(c)).value)!=null?m:{};m=(m=m.thread)!=null?m:{};m=(m=m.thread_items)!=null?m:{};var o=d.nodes;n=(n=m.nodes)!=null?n:[];var p=-1;if(b("nullthrows")(c.graphqlCursor)===((l=m)!=null?(l=l.page_info)!=null?l.end_cursor:l:l))p=n.length-1;else for(var l=n.length-1;l>=0;l--){var q=this.largeNumberCompare(k.lastEntityTime,b("nullthrows")(n[l].time_stamp));if(q===0){p=l;break}else if(q===-1)break}if(p===-1)return a;q=p+1;k=0;l=m.page_info;p=n.slice(0,q);while(k<o.length&&q<n.length){m=o[k];var r=m.token;if(r===null||r===void 0){k++;continue}var s=n[q];r===s.token?(p.push(s),q++,k++):this.largeNumberCompare(b("nullthrows")(s.time_stamp),b("nullthrows")(m.time_stamp))===1?q++:k++}if(k<o.length){l=d.page_info;while(k<o.length){r=o[k];s=r.token;if(s===null||s===void 0){k++;continue}m=this.$IGMessageInboxStore11({type:j.ITEM,inboxID:c.inboxID,token:s});q=this.$IGMessageInboxStore25(a,m);q.hasValue()||i.set(m,{item:Object.assign({},r)});p.push({token:r.token,time_stamp:r.time_stamp});k++}}h=Object.assign({},d,{nodes:p,page_info:l})}f.thread_items=h;g=this.__handleMap(a,i)}return this.$IGMessageInboxStore17(g,c,{thread:f})};d.$IGMessageInboxStore20=function(a,b,c){return this.$IGMessageInboxStore17(a,b,{item:c.instagram_message_thread_item})};d.$IGMessageInboxStore22=function(a,b,c,d){var e;d===void 0&&(d=j.INBOX);d=this.$IGMessageInboxStore21({type:d,inboxID:b});var f=this.$IGMessageInboxStore25(a,d);f=(f=f)!=null?(f=f.value)!=null?f.inbox:f:f;if(f===null||f===void 0)return a;e=(e=f.nodes)!=null?e:[];if(e.length>0&&e.find(function(a){return a.token===c})){var g,h=this.$IGMessageInboxStore21({type:j.THREAD,inboxID:b,token:c});h=(h=this.$IGMessageInboxStore25(a,h))!=null?(h=h.value)!=null?h.thread:h:h;g=(g=(g=f)!=null?g.unseen_count:g)!=null?g:0;b=this.isThreadUnread(b,h);b&&g>0&&(g-=1);h=Object.assign({},f,{nodes:e.filter(function(a){return a.token!==c}),unseen_count:g});return this.$IGMessageInboxStore27(a,d,{inbox:h})}return a};d.$IGMessageInboxStore23=function(a,b,c,d){var e;b=this.$IGMessageInboxStore21({type:j.THREAD,inboxID:b,token:c});c=this.$IGMessageInboxStore25(a,b);c=(c=c)!=null?(c=c.value)!=null?c.thread:c:c;if(c===null||c===void 0)return a;e=(e=(e=c)!=null?(e=e.thread_items)!=null?e.nodes:e:e)!=null?e:[];if(e.length>0&&e.find(function(a){return a.token===d})){e=Object.assign({},c.thread_items,{nodes:e.filter(function(a){return a.token!==d})});c=Object.assign({},c,{thread_items:e});return this.$IGMessageInboxStore27(a,b,{thread:c})}return a};d.$IGMessageInboxStore26=function(a,c,d,e,f,g){var h;g===void 0&&(g=j.INBOX);g=this.$IGMessageInboxStore21({type:g,inboxID:c});c=this.$IGMessageInboxStore25(a,g);c=(c=c)!=null?(c=c.value)!=null?c.inbox:c:c;if(c===null||c===void 0)return a;h=(h=c.nodes)!=null?h:[];if(d===e.token){var i=h.find(function(a){return a.token===d});if(i!==null&&i!==void 0&&i.last_activity_at===e.last_activity_at&&f===0)return a}i=d!==null&&d!==void 0?h.filter(function(a){return d!==a.token}):h;for(h=0;h<i.length;h++)if(this.largeNumberCompare(b("nullthrows")(e.last_activity_at),b("nullthrows")(i[h].last_activity_at))!==-1)break;var k=i.slice(0,h);k.push({token:e.token,last_activity_at:e.last_activity_at});e=(e=c.unseen_count)!=null?e:0;c=Object.assign({},c,{nodes:k.concat(i.slice(h)),unseen_count:e+f});return this.$IGMessageInboxStore27(a,g,{inbox:c})};d.$IGMessageInboxStore24=function(a,c,d,e,f,g){var h,i,k;c=this.$IGMessageInboxStore21({type:j.THREAD,inboxID:c,token:d});d=this.$IGMessageInboxStore25(a,c);d=(d=d)!=null?(d=d.value)!=null?d.thread:d:d;if(d===null||d===void 0)return a;k=(k=(k=d)!=null?(k=k.thread_items)!=null?k.nodes:k:k)!=null?k:[];k=e!==null&&e!==void 0?k.filter(function(a){return e!==a.token}):k;var l;for(l=0;l<k.length;l++)if(this.largeNumberCompare(b("nullthrows")(f.time_stamp),b("nullthrows")(k[l].time_stamp))!==-1)break;var m=k.slice(0,l);i=(i=(i=d)!=null?(i=i.direct_story)!=null?i.unseen_count:i:i)!=null?i:0;h=(h=d)!=null?h.direct_story:h;var n=this.getInboxIGID();if(f.ig_item_type==="RAVEN_MEDIA"&&n!==f.sender_id){var o;g=g!=null?this.isRavenSeenByInbox(g,(g=(g=d)!=null?g.is_group:g)!=null?g:!1,n):!1;o=this.isRavenSeenByInbox(f,(o=(o=d)!=null?o.is_group:o)!=null?o:!1,n);if(g!==o)if(g){h={unseen_count:i-1,media_type:(n=f)!=null?(n=n.raven_media)!=null?n.media_type:n:n}}else{h={unseen_count:i+1,media_type:(o=f)!=null?(o=o.raven_media)!=null?o.media_type:o:o}}}m.push({token:f.token,time_stamp:f.time_stamp});g=Object.assign({},d.thread_items,{nodes:m.concat(k.slice(l))});n=Object.assign({},d,{thread_items:g,last_activity_at:g.nodes[0].time_stamp,direct_story:h});return this.$IGMessageInboxStore27(a,c,{thread:n})};d.$IGMessageInboxStore28=function(a,c,d,e){var f=this.$IGMessageInboxStore21({type:j.ITEM,inboxID:c,token:b("nullthrows")(e.token)});if(d===null||d===void 0)return this.$IGMessageInboxStore27(a,f,{item:e});c=this.$IGMessageInboxStore21({type:j.ITEM,inboxID:c,token:d});d=this.$IGMessageInboxStore25(a,c);e=b("LoadObject").withValue({item:e});d.isDeleting()&&(e=e.deleting());d=this.__setEmpty(a,b("immutable").List.of(c));return d.set(f,e)};d.getCached=function(b){return a.prototype.getCached.call(this,this.$IGMessageInboxStore21(this.$IGMessageInboxStore13(b)))};d.$IGMessageInboxStore25=function(a,c){return a.get(c)||b("LoadObject").empty()};d.__setLoading=function(b,c){var d=[];for(var c=c,e=Array.isArray(c),f=0,c=e?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=c.length)break;g=c[f++]}else{f=c.next();if(f.done)break;g=f.value}g=g;d.push(this.$IGMessageInboxStore21(this.$IGMessageInboxStore13(g)))}return a.prototype.__setLoading.call(this,b,d)};d.$IGMessageInboxStore17=function(a,b,c){b=this.$IGMessageInboxStore21(b);return this.$IGMessageInboxStore27(a,b,c)};d.$IGMessageInboxStore27=function(c,d,e){var f=a.prototype.getCached.call(this,d);if(e instanceof Error)return c.set(d,f.setError(e).done());else{e.inbox&&(b("PagesManagerInboxUnifiedThreadlistAction").setInstagramInbox(e.inbox),b("PagesManagerInboxUnifiedThreadlistAction").setInstagramLoadingError(!1));return c.set(d,f.setValue(e).removeError().done())}};d.$IGMessageInboxStore11=function(a){return JSON.stringify(a)};d.$IGMessageInboxStore21=function(a){return JSON.stringify({type:a.type,inboxID:a.inboxID,token:a.token})};d.$IGMessageInboxStore13=function(a){return JSON.parse(a)};d.getIsInitLoading=function(){return this.$IGMessageInboxStore3};d.largeNumberCompare=function(a,b){if(a.length>b.length)return 1;return a.length<b.length?-1:a===b?0:a>b?1:-1};d.convertTimestamp=function(a){return parseInt(a.slice(0,a.length-3),10)};d.getNowTimestamp=function(){return Date.now().toString()+"000"};d.setInboxIGID=function(a){this.$IGMessageInboxStore4=a};d.getInboxIGID=function(){return this.$IGMessageInboxStore4};d.getInboxID=function(){return this.$IGMessageInboxStore5};d.setInboxProfilePic=function(a){this.$IGMessageInboxStore10=a};d.getInboxProfilePic=function(){return this.$IGMessageInboxStore10};d.getItemType=function(a,b){a=this.getThreadItem(a,b).getValue();return(b=a)!=null?b.ig_item_type:b};d.$IGMessageInboxStore12=function(a){this.$IGMessageInboxStore2.get(a)||(this.$IGMessageInboxStore2.set(a,!0),this.__queueLoadAll(b("immutable").List.of(a)))};d.isMessageExpired=function(a){a=this.largeNumberCompare(a+"000",Date.now().toString());return a<0?!0:!1};d.getUnseenCountDelta=function(a,b,c){b=this.isThreadUnread(a,b);a=this.isThreadUnread(a,c);if(b===a)return 0;return b?-1:1};d.isThreadUnread=function(a,b){return!b?!1:this.hasUnseenMessage(a,b)||this.hasUnseenEphemeral(b)||this.hasMarkedUnread(b)};d.hasUnseenMessage=function(a,c){var d=this.getInboxIGID();if(d===null||d===void 0)return!1;a=c.last_seen_at.find(function(a){return a.user_id===d});if(a===null||a===void 0)return!0;c=b("nullthrows")((c=c)!=null?c.last_activity_at:c);return this.largeNumberCompare(c,b("nullthrows")(a.timestamp))===1};d.hasUnseenEphemeral=function(a){a=(a=a)!=null?(a=a.direct_story)!=null?a.unseen_count:a:a;return a===null||a===void 0||a===0?!1:!0};d.hasMarkedUnread=function(a){a=(a=a)!=null?a.is_read:a;return a===null||a===void 0||a===!1?!0:!1};d.isRavenSeenByInbox=function(a,b,c){var d;if(c===null||c===void 0)return!1;d=(d=(d=a)!=null?(d=d.raven_media)!=null?d.seen_count:d:d)!=null?d:0;a=(a=(a=a)!=null?(a=a.raven_media)!=null?a.seen_user_ids:a:a)!=null?a:[];if(b)return a.some(function(a){return a===c});else return d>0};d.getLocallyUpdatedUnreadCount=function(a){a===void 0&&(a=!1);if(this.$IGMessageInboxStore5==null)return null;var c=b("LoadObject").empty(),d=Boolean(this.$IGMessageInboxStore8),e=Boolean(this.$IGMessageInboxStore9);c=this.getInbox(b("nullthrows")(this.$IGMessageInboxStore5),this.$IGMessageInboxStore6,null,this.$IGMessageInboxStore7,d,e,null,a);if(c.hasValue()){return(d=c.getValue())!=null?d.unseen_count:d}a=c.hasError()?(e=c.getError())!=null?e.message:e:null;b("PagesManagerInboxUnifiedThreadlistAction").setInstagramLoadingError(c.hasError());a!=null&&b("FBLogger")("pages_messaging_www").warn("Encounter error when loading IG inbox for updating unread count: %s",a);return null};return c}(b("FluxLoadObjectStore"));a.__moduleID=e.id;e.exports=new a(b("IGMessageDataDispatcher"))}),null);
__d("IGMessageDataMutateAction",["invariant","IGMessageDataDispatcher","IGMessageDataMutateActionTypes","IGMessageInboxStore"],(function(a,b,c,d,e,f,g){"use strict";var h={INBOX:"INBOX",THREAD:"THREAD",ITEM:"ITEM"},i="TODO";a={forceFetchInbox:function(a,c,d,e,f,j,k){var l;d===void 0&&(d=i);k===void 0&&(k=!1);l=(l=c)!=null?l:1;l>=1||g(0,11872);b("IGMessageDataDispatcher").dispatch({request:{type:h.INBOX,inboxID:a,limit:c,folder:d,is_follow_up:e,is_unread:f,assigned_admin_id:j,fetch_from_user:k},type:b("IGMessageDataMutateActionTypes").FORCE_FETCH})},forceFetchThread:function(a,c,d,e){e===void 0&&(e=!1);d=(d=d)!=null?d:1;d>=1||g(0,11872);b("IGMessageDataDispatcher").dispatch({request:{type:h.THREAD,inboxID:a,token:c,limit:d,fetch_from_user:e},type:b("IGMessageDataMutateActionTypes").FORCE_FETCH})},forceFetchThreadItem:function(a,c,d){b("IGMessageDataDispatcher").dispatch({request:{type:h.ITEM,inboxID:a,token:c,limit:d},type:b("IGMessageDataMutateActionTypes").FORCE_FETCH})},markThreadAsDeleting:function(a,c){b("IGMessageDataDispatcher").dispatch({request:{type:h.THREAD,inboxID:a,token:c},type:b("IGMessageDataMutateActionTypes").DELETING})},markThreadItemAsDeleting:function(a,c){b("IGMessageDataDispatcher").dispatch({request:{type:h.ITEM,inboxID:a,token:c},type:b("IGMessageDataMutateActionTypes").DELETING})},deleteThread:function(a,c){b("IGMessageDataDispatcher").dispatch({request:{type:h.THREAD,inboxID:a,token:c},type:b("IGMessageDataMutateActionTypes").DELETE})},deleteThreadItem:function(a,c,d){b("IGMessageDataDispatcher").dispatch({request:{type:h.ITEM,inboxID:a,token:d},type:b("IGMessageDataMutateActionTypes").DELETE,extraData:{threadToken:c}})},markThreadItemAsCreating:function(a,c,d){b("IGMessageDataDispatcher").dispatch({request:{type:h.ITEM,inboxID:a},type:b("IGMessageDataMutateActionTypes").CREATING,payload:{item:d},extraData:{threadToken:c}})},createThread:function(a,c){b("IGMessageDataDispatcher").dispatch({request:{type:h.THREAD,inboxID:a},type:b("IGMessageDataMutateActionTypes").CREATE,payload:{thread:c}})},createThreadItem:function(a,c,d){b("IGMessageDataDispatcher").dispatch({request:{type:h.ITEM,inboxID:a},type:b("IGMessageDataMutateActionTypes").CREATE,payload:{item:d},extraData:{threadToken:c}})},updateInbox:function(a,c,d){d===void 0&&(d=!1),b("IGMessageDataDispatcher").dispatch({request:{type:h.INBOX,inboxID:a,fetch_from_user:d},type:b("IGMessageDataMutateActionTypes").UPDATE,payload:{inbox:c}})},updateThread:function(a,c,d,e){e===void 0&&(e=!1),b("IGMessageDataDispatcher").dispatch({request:{type:h.THREAD,inboxID:a,token:c,fetch_from_user:e},type:b("IGMessageDataMutateActionTypes").UPDATE,payload:{thread:d}})},updateThreadItem:function(a,c,d,e){b("IGMessageDataDispatcher").dispatch({request:{type:h.ITEM,inboxID:a,token:d},type:b("IGMessageDataMutateActionTypes").UPDATE,payload:{item:e},extraData:{threadToken:c}})},markThreadAsSeen:function(a,c,d,e,f){var g=b("IGMessageInboxStore").getThread(a,c).getValue(),h=f===null||f===void 0?b("IGMessageInboxStore").getInboxIGID():f;g=(((f=g)!=null?f.last_seen_at:f)||[]).filter(function(a){return a.user_id!==h});g.push({item_id:d,timestamp:e,user_id:h});this.updateThread(a,c,{last_seen_at:g})},markRavenAsSeen:function(a,c,d,e){var f=b("IGMessageInboxStore").getThread(a,c).getValue(),g=b("IGMessageInboxStore").getInboxIGID();f=(((f=f)!=null?f.last_seen_at:f)||[]).filter(function(a){return a.user_id!==g});f.push({item_id:d,timestamp:e,user_id:g});this.updateThread(a,c,{last_seen_at:f})},updateThreadFollowUpStatus:function(a,b,c){this.updateThread(a,b,{is_follow_up:c})},updateThreadReadStatus:function(a,b,c){this.updateThread(a,b,{is_read:c})},updateThreadAdminStatus:function(a,b,c,d,e){this.updateThread(a,b,{assigned_admin:{id:c,name:d,profile_picture:{uri:e}}})},likeThreadItem:function(a,c,d,e){var f,g=b("IGMessageInboxStore").getThreadItem(a,d).getValue(),h=b("IGMessageInboxStore").getInboxIGID(),i=b("IGMessageInboxStore").getInboxProfilePic();f=((f=g)!=null?(f=f.ig_reaction)!=null?f.likes:f:f)||[];if(f.find(function(a){return a.instagram_user_id===h}))return;f=f.filter(function(a){return a.instagram_user_id!==h});f.push({instagram_user_id:h,profile_picture:{uri:i}});e={time_stamp:e,ig_reaction:{likes_count:(((i=g)!=null?(i=i.ig_reaction)!=null?i.likes_count:i:i)||0)+1,likes:f}};(e.time_stamp===null||e.time_stamp===void 0||e.time_stamp==="")&&delete e.time_stamp;this.updateThreadItem(a,c,d,e)},unlikeThreadItem:function(a,c,d){var e,f=b("IGMessageInboxStore").getThreadItem(a,d).getValue(),g=b("IGMessageInboxStore").getInboxIGID();e=((e=f)!=null?(e=e.ig_reaction)!=null?e.likes:e:e)||[];if(!e.find(function(a){return a.instagram_user_id===g}))return;e=e.filter(function(a){return a.instagram_user_id!==g});f=(((f=f)!=null?(f=f.ig_reaction)!=null?f.likes_count:f:f)||0)-1;f<0&&(f=0);this.updateThreadItem(a,c,d,{ig_reaction:{likes_count:f,likes:e}})}};e.exports=a}),null);
__d("CRMEventsTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1={}}var c=a.prototype;c.log=function(){b("GeneratedLoggerUtils").log("logger:CRMEventsLoggerConfig",this.$1,b("Banzai").BASIC)};c.logVital=function(){b("GeneratedLoggerUtils").log("logger:CRMEventsLoggerConfig",this.$1,b("Banzai").VITAL)};c.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:CRMEventsLoggerConfig",this.$1,{signal:!0})};c.clear=function(){this.$1={};return this};c.getData=function(){return babelHelpers["extends"]({},this.$1)};c.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.setBusinessPresenceID=function(a){this.$1.business_presence_id=a;return this};c.setCrmReminderID=function(a){this.$1.crm_reminder_id=a;return this};c.setErrorMessage=function(a){this.$1.error_message=a;return this};c.setErrorTrace=function(a){this.$1.error_trace=a;return this};c.setEvent=function(a){this.$1.event=a;return this};c.setIsServerLog=function(a){this.$1.is_server_log=a;return this};c.setPageContactID=function(a){this.$1.page_contact_id=a;return this};c.setPageID=function(a){this.$1.page_id=a;return this};c.setReferrerUIComponent=function(a){this.$1.referrer_ui_component=a;return this};c.setReferrerUISurface=function(a){this.$1.referrer_ui_surface=a;return this};c.setTime=function(a){this.$1.time=a;return this};c.setUIComponent=function(a){this.$1.ui_component=a;return this};c.setUISurface=function(a){this.$1.ui_surface=a;return this};c.setVC=function(a){this.$1.vc=a;return this};c.setWeight=function(a){this.$1.weight=a;return this};c.updateExtraData=function(a){a=b("nullthrows")(b("GeneratedLoggerUtils").serializeMap(a));b("GeneratedLoggerUtils").checkExtraDataFieldNames(a,g);this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.addToExtraData=function(a,b){var c={};c[a]=b;return this.updateExtraData(c)};return a}();var g={business_presence_id:!0,crm_reminder_id:!0,error_message:!0,error_trace:!0,event:!0,is_server_log:!0,page_contact_id:!0,page_id:!0,referrer_ui_component:!0,referrer_ui_surface:!0,time:!0,ui_component:!0,ui_surface:!0,vc:!0,weight:!0};e.exports=a}),null);
__d("PagesMessagingInboxActionsTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1={}}var c=a.prototype;c.log=function(){b("GeneratedLoggerUtils").log("logger:PagesMessagingInboxActionsLoggerConfig",this.$1,b("Banzai").BASIC)};c.logVital=function(){b("GeneratedLoggerUtils").log("logger:PagesMessagingInboxActionsLoggerConfig",this.$1,b("Banzai").VITAL)};c.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:PagesMessagingInboxActionsLoggerConfig",this.$1,{signal:!0})};c.clear=function(){this.$1={};return this};c.getData=function(){return babelHelpers["extends"]({},this.$1)};c.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.setInboxAction=function(a){this.$1.inbox_action=a;return this};c.setPageCommSearchType=function(a){this.$1.page_comm_search_type=a;return this};c.setPlatform=function(a){this.$1.platform=a;return this};c.setTime=function(a){this.$1.time=a;return this};c.setVC=function(a){this.$1.vc=a;return this};c.setWeight=function(a){this.$1.weight=a;return this};c.updateExtraData=function(a){a=b("nullthrows")(b("GeneratedLoggerUtils").serializeMap(a));b("GeneratedLoggerUtils").checkExtraDataFieldNames(a,g);this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.addToExtraData=function(a,b){var c={};c[a]=b;return this.updateExtraData(c)};return a}();var g={inbox_action:!0,page_comm_search_type:!0,platform:!0,time:!0,vc:!0,weight:!0};e.exports=a}),null);
__d("PagesMessagingPerfTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1={}}var c=a.prototype;c.log=function(){b("GeneratedLoggerUtils").log("logger:PagesMessagingPerfLoggerConfig",this.$1,b("Banzai").BASIC)};c.logVital=function(){b("GeneratedLoggerUtils").log("logger:PagesMessagingPerfLoggerConfig",this.$1,b("Banzai").VITAL)};c.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:PagesMessagingPerfLoggerConfig",this.$1,{signal:!0})};c.clear=function(){this.$1={};return this};c.getData=function(){return babelHelpers["extends"]({},this.$1)};c.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.setEventName=function(a){this.$1.event_name=a;return this};c.setExceptionCode=function(a){this.$1.exception_code=a;return this};c.setExceptionMessage=function(a){this.$1.exception_message=a;return this};c.setPageID=function(a){this.$1.page_id=a;return this};c.setPerfTime=function(a){this.$1.perf_time=a;return this};c.setPlatform=function(a){this.$1.platform=a;return this};c.setStack=function(a){this.$1.stack=a;return this};c.setThreadID=function(a){this.$1.thread_id=a;return this};c.setThreadOffset=function(a){this.$1.thread_offset=a;return this};c.setTime=function(a){this.$1.time=a;return this};c.setVC=function(a){this.$1.vc=a;return this};c.setWeight=function(a){this.$1.weight=a;return this};return a}();c={event_name:!0,exception_code:!0,exception_message:!0,page_id:!0,perf_time:!0,platform:!0,stack:!0,thread_id:!0,thread_offset:!0,time:!0,vc:!0,weight:!0};e.exports=a}),null);
__d("CRMCSVFileInput.react",["ix","cx","fbt","DragDropTarget","FDSButton.react","FDSCloseButton.react","FDSProgressBar.react","FDSText.react","FileInput.react","Image.react","Link.react","React","ReactDOM","asset","cxMargin"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j=b("React");a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.$1=null,c.$2=function(a){c.$1=a},c.$4=function(a){return c.props.onUpload(a.target.files,a.target)},b)||babelHelpers.assertThisInitialized(c)}var d=c.prototype;d.componentDidMount=function(){var a=this;if(this.$1){var c=b("ReactDOM").findDOMNode(this.$1);new(b("DragDropTarget"))(c).setOnFilesDropCallback(function(b){a.props.onUpload(b,c)}).enable()}};d.$3=function(a){if(a===null||a===void 0)return null;var b=a/1024/1024;if(b>1)return b.toFixed(1).toString().concat("MB");b=a/1024;return b.toFixed(1).toString().concat("KB")};d.$5=function(){var a=this.props,c=a.fileName;a=a.fileError;return j.jsx("div",{className:"_7ose _7jwq",ref:this.$2,children:j.jsxs("div",{className:"_7jwr",children:[j.jsx("div",{className:"_7jwt",children:j.jsx(b("FDSCloseButton.react"),{onClick:this.props.onClose})}),j.jsxs("div",{className:"_7jws",children:[j.jsx(b("Image.react"),{className:"_3-90",src:g("651651")}),j.jsx(b("FDSText.react"),{color:"secondary",size:"header3",weight:"bold",children:c})]}),j.jsx("div",{className:"_3-96",children:j.jsx(b("FDSText.react"),{color:"secondary",size:"body1",children:a})}),j.jsx(b("FileInput.react"),{accept:".csv,.xls,.xlsx",name:"file",onChange:this.props.onUpload,value:"",children:j.jsx(b("FDSButton.react"),{href:"#",icon:j.jsx(b("Image.react"),{className:"_3-90",src:g("651651")}),label:i._("Choose File"),margin:"_3-90",size:"large",use:"default"})})]})})};d.$6=function(){var a=this.props,c=a.fileName,d=a.fileSize;a=a.isUploading;return a?j.jsx("div",{className:"_7jwq _7osf",children:j.jsxs("div",{className:"_7jwr",children:[j.jsxs("div",{className:"_7jws",children:[j.jsx(b("Image.react"),{className:"_3-90",src:g("538041")}),j.jsx(b("FDSText.react"),{color:"secondary",size:"header3",weight:"bold",children:i._("Uploading \"{filename}\"",[i._param("filename",c)])})]}),j.jsx("div",{children:j.jsx(b("FDSProgressBar.react"),{type:"buffering"})})]})}):j.jsx("div",{className:"_7jwq _7osf",children:j.jsxs("div",{className:"_7jwr",children:[j.jsx("div",{className:"_7jwt",children:j.jsx(b("FDSCloseButton.react"),{onClick:this.props.onClose})}),j.jsxs("div",{className:"_7jws",children:[j.jsx(b("Image.react"),{className:"_3-90",src:g("651651")}),j.jsx(b("FDSText.react"),{color:"secondary",size:"header3",weight:"bold",children:c})]}),j.jsx("div",{children:j.jsx(b("FDSText.react"),{color:"secondary",size:"body1",children:this.$3(d)})})]})})};d.render=function(){if(this.props.fileError!=null)return this.$5();return this.props.isUploading||this.props.fileName!==null?this.$6():j.jsxs("div",{className:"_7j3x _7jwq",ref:this.$2,children:[j.jsx("div",{children:j.jsx(b("FDSText.react"),{color:"secondary",size:"body1",weight:"bold",children:i._("Upload file")})}),j.jsx(b("FDSText.react"),{color:"secondary",margin:"_3-8p",size:"body3",children:i._("Choose a CSV, XLS or XLSX file, or drag and drop to upload. Maximum file size is 1 MB.")}),this.props.csvTemplate!=null?j.jsxs(b("Link.react"),{className:"_8p_2",href:this.props.csvTemplate,children:[j.jsx(b("Image.react"),{className:"_3-90",src:g("406900")}),j.jsx(b("FDSText.react"),{color:"blueLink",size:"body2",children:i._("Download Template")})]}):null,j.jsx(b("FileInput.react"),{accept:".csv,.xls,.xlsx",name:"file",onChange:this.$4,value:"",children:j.jsx(b("FDSButton.react"),{href:"#",icon:j.jsx(b("Image.react"),{src:g("651653")}),label:i._("Choose File"),margin:"_3-8p",size:"large",use:"primary"})})]})};return c}(j.PureComponent);e.exports=a}),null);
__d("PagesMarketingAutomationEditView.react",["ix","cx","fbt","AdsMessengerPartialAutomatedCreationTypes","AdsMessengerPartialAutomatedCreationUtils","AppointmentFollowUpMessageEditor.react","FBConfirmDialog.react","FBMoreLink.react","FDSButton.react","FDSCancelButton.react","FDSCheckboxInput.react","FDSLink.react","FDSModal.react","FDSModalFooter.react","FDSModalHeader.react","FDSSection.react","FDSText.react","IcebreakerFreeTextEditor.react","Image.react","MessengerAdsConversionFunnelTypedLogger","PagesAutomatedQuestionnaireMessageItem.react","PagesAutomatedQuestionnairePrivacyPolicyItem.react","PagesAutomatedResponsesAwayTimeRangeEditorRoot.react","PagesContentEditorConstants","PagesCreateSavedResponseMutation","PagesDeleteSavedResponseMutation","PagesEditSavedResponseMutation","PageSetAwayConfigMutation","PagesManagerAction","PagesManagerComposerSectionCard.react","PagesManagerComposerTopBar.react","PagesManagerInboxFAQConstants","PagesManagerInboxLogger","PagesMarketingAutomationActions","PagesMarketingAutomationCheckoutQuestionComposer.react","PagesMarketingAutomationContentUtils","PagesMarketingAutomationContentView.react","PagesMarketingAutomationCreateMutation","PagesMarketingAutomationMessageComposer.react","PagesMarketingAutomationReengagementMessages.react","PagesMarketingAutomationStore","PagesMarketingAutomationUpdateMutation","PagesMarketingAutomationUtils","PagesMessagingInboxActionLogger","PagesMessengerCustomQuestionsPreview.react","PagesMessengerPreview.react","PagesMessengerReengagementPreview.react","PagesOrganicIntakeFormQuestionComposer.react","PagesQPCPromptQuestionItem.react","PagesQPCQuestionComposer.react","PagesTimeRangeEditorUtilities","PageUpdateCustomIcebreakersMutation","React","ResponsiveBlock.react","SavedResponsesConstants","SavedResponsesUtils","ServicesEventsLogger","ServicesFollowUpMessageSettingMutation","ServicesQPCFlow","WebFunnelLogger","asset","cxMargin","debounce","enumUtils","qex"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j=b("AdsMessengerPartialAutomatedCreationTypes").AdsMessengerPartialAutomatedCreationGoToOption,k=b("AdsMessengerPartialAutomatedCreationTypes").AdsMessengerPartialAutomatedCreationNonPrefillAnswer,l=b("PagesContentEditorConstants").PagesContentEditorMessageComposerSpecialTypes,m=b("PagesManagerInboxFAQConstants").FAQ_MENU_REPLACE_CTA_TITLE,n=b("PagesManagerInboxFAQConstants").FAQ_MENU_REPLACE_WARN_DESCRIPTION,o=b("PagesManagerInboxFAQConstants").FAQ_MENU_REPLACE_WARN_TITLE,p=(a=b("PagesMarketingAutomationContentUtils")).getAdminGhostText,q=a.getContentForEditHeader,r=a.getContentForIncompatibilityDisclaimerModal,s=a.getContentForModalDetail,t=a.getContentForModalTitle,u=a.getPlacementContent,v=a.getTimingContent,w=a.getTimingNote,x=a.getTitleForIncompatibilityDisclaimerModal,y=b("PagesMarketingAutomationContentView.react").shuffleDemoIcebreakers,z=(c=b("PagesMarketingAutomationUtils")).getAutomatedCheckoutData,A=c.getOrganicIntakeFormData,B=c.getPagesMarketingAutomationReengagementDataInput,C=c.getPlatformStatus,D=c.getShouldShowIGDirectAutomatedResponse,E=c.getTriggerWaitTime,F=c.sendPreview,G=c.shouldShowAdminTextForSmartReply,H=b("React"),I=b("ServicesFollowUpMessageSettingMutation").commitMutationFollowUpMessage;function J(a){return H.jsx(b("FDSModal.react"),{footer:H.jsx(b("FDSModalFooter.react"),{primaryButton:H.jsx(b("FDSButton.react"),{label:i._("Save"),onClick:a.onConfirmClick,use:"primary"}),secondaryButton:H.jsx(b("FDSCancelButton.react"),{})}),header:H.jsx(b("FDSModalHeader.react"),{title:i._("Save away schedule changes?")}),isShown:a.isShown,onHide:a.onCancelClick,children:H.jsx(b("FDSSection.react"),{children:H.jsx(b("FDSText.react"),{children:i._("Changes to your away schedule will cause your Page to be away after changes have been saved. You can make your Page available at any time in Inbox.")})})})}function K(a){return a.modalPurpose==null?null:H.jsx(b("FDSModal.react"),{footer:H.jsx(b("FDSModalFooter.react"),{primaryButton:H.jsx(b("FDSButton.react"),{label:a.modalPurpose==="CUSTOM_QUESTIONS"?m:i._("Save"),onClick:a.onConfirmClick,use:"primary"}),secondaryButton:H.jsx(b("FDSCancelButton.react"),{})}),header:H.jsx(b("FDSModalHeader.react"),{title:t(a.modalPurpose)}),isShown:a.isShown,onHide:a.onCancelClick,children:H.jsx(b("FDSSection.react"),{children:H.jsx(b("FDSText.react"),{children:s(a.modalPurpose)})})})}function L(a){return H.jsx(b("FDSModal.react"),{footer:H.jsx(b("FDSModalFooter.react"),{primaryButton:H.jsx(b("FDSButton.react"),{label:m,onClick:a.onConfirmClick,use:"primary"}),secondaryButton:H.jsx(b("FDSCancelButton.react"),{})}),header:H.jsx(b("FDSModalHeader.react"),{title:o}),isShown:a.isShown,onHide:a.onCancelClick,children:H.jsx(b("FDSSection.react"),{children:H.jsx(b("FDSText.react"),{children:n})})})}function M(a){return H.jsx(b("PagesMarketingAutomationReengagementMessages.react"),{automationID:a.automationID,data:a.data,onAddMessage:a.onAddMessage,onIndexedCTAChange:a.onIndexedCTAChange,onIndexedMediaChange:a.onIndexedMediaChange,onIndexedMediaTypeChange:a.onIndexedMediaTypeChange,onIndexedTimeChange:a.onIndexedTimeChange,onMessageChange:a.onMessageChange,onRemoveMessage:a.onRemoveMessage,onRulesChange:a.onRulesChange,pageID:a.pageID})}function N(a){return H.jsxs(H.Fragment,{children:[P(a.automatedCheckoutMessages)?H.jsx(b("PagesManagerComposerSectionCard.react"),{body:H.jsx(b("PagesMarketingAutomationMessageComposer.react"),{attachmentType:null,automationID:a.automationID,ctas:null,errors:null,hideAttachmentSection:a.shouldHideAttachment,hideCTASection:a.shouldHideCTA,isWelcomeTextIntialized:a.isWelcomeTextInitialized,media:null,onMessageChange:a.onQuestionnaireDisqualificationMessageChange,pageID:a.pageID,showPersonalization:!1,showTimeSection:!1,welcomeText:a.questionnaireDisqualificationMessage}),header:i._("Disqualification message"),isCollapsible:!1,leftIcon:H.jsx("div",{className:"_6as2 _8orc",children:H.jsx(b("Image.react"),{src:g("1122037")})}),subtitle:i._("Send people a different message if you disqualify an answer.")}):null,H.jsx(b("PagesManagerComposerSectionCard.react"),{body:H.jsx(b("PagesAutomatedQuestionnairePrivacyPolicyItem.react"),{onQuestionnairePrivacyPolicyURLChange:a.onQuestionnairePrivacyPolicyURLChange,placeHolder:b("SavedResponsesConstants").privacyPolicyURL,questionnairePrivacyPolicyURL:a.questionnairePrivacyPolicyURL}),header:i._("Your Privacy Policy URL"),isCollapsible:!1,leftIcon:H.jsx("div",{className:"_6as2 _8kmo",children:H.jsx(b("Image.react"),{src:g("502604")})}),subtitle:i._("Because you'll be collecting customer information, we strongly recommend that you include a link to your business's privacy policy.")}),H.jsx(b("PagesManagerComposerSectionCard.react"),{body:H.jsx(b("PagesAutomatedQuestionnaireMessageItem.react"),{automationID:a.automationID,content:a.questionnaireStopQuestionsMessage,errors:a.errors,onIntroMessageChange:a.onQuestionnaireStopQuestionsMessageChange,pageID:a.pageID,specialType:l.QUESTIONNAIRE_STOP_QUESTIONS_MESSAGE}),header:i._("Pause automated questions"),isCollapsible:!1,leftIcon:H.jsx("div",{className:"_6as2 _8j8x",children:H.jsx(b("Image.react"),{src:g("1122037")})}),subtitle:i._("A \"Pause questions\" option lets people end this automated chat at any time. Let them know that they've paused questions and what they can do next.")})]})}function O(a){var c=b("PagesMarketingAutomationStore").getAutomatedCheckoutStepListID()?"existing_setup":"new_setup";new(b("MessengerAdsConversionFunnelTypedLogger"))().setName("buyer_information_setup_impression").setConversionType("BUYER_INFORMATION").setEventType(a.automationType).setEventSubtype(c).setPageID(a.pageID).log();c=a.automationType==="buyer_information_form"?i._("Introduce the questions you'll ask to collect customers' information for making purchases."):i._("Introduce the questions you'll ask to collect people's information for making purchases.");var d=a.automationType==="buyer_information_form"?i._("Create a form of questions to collect customer information."):i._("Customize the questions you will send in sequence."),e=H.jsx(b("PagesManagerComposerSectionCard.react"),{body:H.jsx(b("PagesMarketingAutomationMessageComposer.react"),{attachmentType:null,automationID:a.automationID,ctas:null,errors:null,hideAttachmentSection:a.shouldHideAttachment,hideCTASection:a.shouldHideCTA,isWelcomeTextIntialized:a.isWelcomeTextInitialized,media:null,onMessageChange:a.onThankYouMessageChange,pageID:a.pageID,showPersonalization:!1,showTimeSection:!1,welcomeText:a.automatedCheckoutMessages.thankYouMessage}),header:i._("Completion message"),isCollapsible:!1,leftIcon:H.jsx("div",{className:"_6as2 _8o9j",children:H.jsx(b("Image.react"),{src:g("1122023")})}),subtitle:i._("Thank people for their answers and let them know what happens next.")});return H.jsxs(H.Fragment,{children:[H.jsx(b("PagesManagerComposerSectionCard.react"),{body:H.jsx(b("PagesMarketingAutomationMessageComposer.react"),{attachmentType:null,automationID:a.automationID,ctas:null,errors:null,hideAttachmentSection:a.shouldHideAttachment,hideCTASection:a.shouldHideCTA,isWelcomeTextIntialized:a.isWelcomeTextInitialized,media:null,onMessageChange:a.onIntroMessageChange,pageID:a.pageID,showPersonalization:!1,showTimeSection:!1,welcomeText:a.automatedCheckoutMessages.introMessage}),header:i._("Intro"),isCollapsible:!1,leftIcon:H.jsx("div",{className:"_6as2 _6as8",children:H.jsx(b("Image.react"),{src:g("561662")})}),subtitle:c}),H.jsx(b("PagesManagerComposerSectionCard.react"),{body:H.jsx(b("PagesMarketingAutomationCheckoutQuestionComposer.react"),{automatedCheckoutMessages:a.automatedCheckoutMessages,onAddQuestion:a.onAddQuestion,onQuestionMessageChange:a.onQuestionMessageChange,onRemoveQuestion:a.onRemoveQuestion,pageID:a.pageID,showError:!1}),header:a.automatedCheckoutMessages.questionMessages.length>1?i._("Questions"):i._("Question"),isCollapsible:!1,leftIcon:H.jsx("div",{className:"_6as2 _87a7",children:H.jsx(b("Image.react"),{src:g("598398")})}),subtitle:d}),a.automationType==="automated_checkout"?H.jsxs("div",{children:[H.jsx(b("PagesManagerComposerSectionCard.react"),{body:H.jsx(b("PagesAutomatedQuestionnaireMessageItem.react"),{automationID:a.automationID,content:a.questionnaireReminderMessage,errors:a.errors,onIntroMessageChange:a.onQuestionnaireReminderMessageChange,pageID:a.pageID,specialType:l.QUESTIONNAIRE_REMINDER_MESSAGE}),header:i._("Reminder"),isCollapsible:!1,leftIcon:H.jsx("div",{className:"_6as2 _8o9h",children:H.jsx(b("Image.react"),{src:g("537339")})}),subtitle:i._("Send an automated message to people who haven't finished your questions within 24 hours.")}),H.jsx(b("PagesManagerComposerSectionCard.react"),{body:H.jsx(b("PagesAutomatedQuestionnaireMessageItem.react"),{automationID:a.automationID,content:a.questionnaireSummaryMessage,errors:a.errors,onIntroMessageChange:a.onQuestionnaireSummaryMessageChange,pageID:a.pageID,specialType:l.QUESTIONNAIRE_SUMMARY_MESSAGE}),header:i._("Summary"),isCollapsible:!1,leftIcon:H.jsx("div",{className:"_6as2 _8o9i",children:H.jsx(b("Image.react"),{src:g("480666")})}),subtitle:i._("Send people a message to go along with a summary of their details.")}),e,H.jsx(b("FBMoreLink.react"),{allowToggle:!0,className:"_8qxd",isCollapsed:!a.shouldShowAdvancedOptions,lessLabel:i._("Hide advanced options"),moreLabel:i._("Show advanced options"),onClick:function(){return b("PagesMarketingAutomationActions").updateShouldShowAdvancedOptions(!a.shouldShowAdvancedOptions)}})]}):e,a.shouldShowAdvancedOptions?N(a):null]})}function P(a){a=a.questionMessages;return a.some(function(a){return a.goToOptions&&a.goToOptions.some(function(a){return a===j.DISQUALIFY_MESSAGE})})}function Q(a){return H.jsxs(H.Fragment,{children:[H.jsx(b("PagesManagerComposerSectionCard.react"),{body:H.jsx(b("PagesAutomatedQuestionnairePrivacyPolicyItem.react"),{onQuestionnairePrivacyPolicyURLChange:a.onQuestionnairePrivacyPolicyURLChange,questionnairePrivacyPolicyURL:a.questionnairePrivacyPolicyURL}),header:i._("Privacy Policy (optional)"),isCollapsible:!1,leftIcon:H.jsx("div",{className:"_6as2 _8kmo",children:H.jsx(b("Image.react"),{src:g("482269")})}),subtitle:i._("If you'll be collecting customer information, we strongly recommend that you include a link to your business' privacy policy.")}),H.jsx(b("PagesManagerComposerSectionCard.react"),{body:H.jsx(b("PagesAutomatedQuestionnaireMessageItem.react"),{automationID:a.automationID,content:a.questionnaireStopQuestionsMessage,errors:a.errors,onIntroMessageChange:a.onQuestionnaireStopQuestionsMessageChange,pageID:a.pageID,specialType:l.QUESTIONNAIRE_STOP_QUESTIONS_MESSAGE}),header:i._("Confirmation to pause questions"),isCollapsible:!1,leftIcon:H.jsx("div",{className:"_6as2 _8j8x",children:H.jsx(b("Image.react"),{src:g("681572")})}),subtitle:i._("A \"Pause questions\" option lets people end this automated chat at any time. Let them know that they've paused questions and what they can do next.")})]})}function R(a){var c=a.isCollapsed?i._("Show advanced options"):i._("Hide advanced options"),d=a.isCollapsed?g("510357"):g("537237");return H.jsxs("div",{className:"_8qxd",children:[H.jsx(b("FDSText.react"),{color:"highlight",size:"body1",weight:"bold",children:H.jsx(b("FDSLink.react"),{onClick:a.onClickQPCAdvancedOptionsLink,children:c})}),H.jsx(b("Image.react"),{className:"_8y4f",src:d})]})}function S(a){var c;return H.jsxs(H.Fragment,{children:[H.jsx(c=b("PagesManagerComposerSectionCard.react"),{header:i._("Overview"),isCollapsible:!1,leftIcon:H.jsx("div",{className:"_6as2 _6as7",children:H.jsx(b("Image.react"),{src:g("650922")})}),subtitle:i._("Sent instantly to people who contact your Page for the first time.")}),H.jsx(c,{body:H.jsx("div",{children:H.jsx(b("PagesAutomatedQuestionnaireMessageItem.react"),{automationID:a.automationID,content:a.organicIntakeFormMessages.introMessage,errors:a.errors,onIntroMessageChange:a.onIntroMessageChange,pageID:a.pageID,specialType:l.QUESTIONNAIRE_WELCOME_MESSAGE})}),header:i._("Intro"),isCollapsible:!1,leftIcon:H.jsxs("div",{className:"_6as2 _8icd",children:[H.jsx(b("Image.react"),{src:g("495272")})," "]}),subtitle:i._("Welcome people to the conversation.")}),H.jsx(c,{body:H.jsx("div",{children:H.jsx(b("PagesQPCPromptQuestionItem.react"),{errors:a.errors,onPromptQuestionChange:a.onPromptQuestionChange,pageID:a.pageID,qpcPromptQuestion:a.qpcPromptQuestion})}),header:i._("Question prompt"),initialExpanded:a.isQPCPromptQuestionEnabled,isCollapsible:!0,leftIcon:H.jsx("div",{className:"_6as2 _8yxj",children:H.jsx(b("Image.react"),{src:g("813966")})}),onClick:a.onToggleQPCPromptQuestion,subtitle:i._("After your intro, this prompt will be sent so people can choose to either answer your questions or message you directly."),useCollapseToggleSwitch:!0}),H.jsx(c,{body:b("qex")._("1241531")?H.jsx(b("PagesQPCQuestionComposer.react"),{errors:a.errors,messages:a.organicIntakeFormMessages.questionMessages,onAddQuestion:a.onAddQuestion,onQuestionMessageChange:a.onQuestionMessageChange,onRemoveQuestion:a.onRemoveQuestion,pageID:a.pageID}):H.jsx(b("PagesOrganicIntakeFormQuestionComposer.react"),{errors:a.errors,messages:a.organicIntakeFormMessages.questionMessages,onAddQuestion:a.oldOnAddQuestion,onQuestionMessageChange:a.oldOnQuestionMessageChange,onRemoveQuestion:a.onRemoveQuestion}),header:i._("Questions"),isCollapsible:!1,leftIcon:H.jsx("div",{className:"_6as2 _8y4p",children:H.jsx(b("Image.react"),{src:g("598398")})}),subtitle:i._("Ask a sequence of questions to see if people are potential customers. These questions help qualify your leads.")}),H.jsx(b("PagesManagerComposerSectionCard.react"),{body:H.jsx(b("PagesAutomatedQuestionnaireMessageItem.react"),{automationID:a.automationID,content:a.questionnaireReminderMessage,errors:a.errors,onIntroMessageChange:a.onQuestionnaireReminderMessageChange,pageID:a.pageID,specialType:l.QUESTIONNAIRE_REMINDER_MESSAGE}),header:i._("Reminder"),isCollapsible:!1,leftIcon:H.jsx("div",{className:"_6as2 _8j8w",children:H.jsx(b("Image.react"),{src:g("537339")})}),subtitle:i._("Send an automated message to people who haven't finished your questions within 24 hours.")}),H.jsx(b("PagesManagerComposerSectionCard.react"),{body:H.jsx(b("PagesAutomatedQuestionnaireMessageItem.react"),{automationID:a.automationID,content:a.organicIntakeFormMessages.thankYouMessage,errors:a.errors,onIntroMessageChange:a.onThankYouMessageChange,pageID:a.pageID,specialType:l.QUESTIONNAIRE_THANK_YOU_MESSAGE}),header:i._("Completion message"),isCollapsible:!1,leftIcon:H.jsx("div",{className:"_6as2 _8y4q",children:H.jsx(b("Image.react"),{src:g("1122023")})}),subtitle:i._("Thank people for their answers and let them know what happens next")}),H.jsx(R,{isCollapsed:!a.shouldShowAdvancedOptions,onClickQPCAdvancedOptionsLink:a.onClickQPCAdvancedOptionsLink}),a.shouldShowAdvancedOptions&&H.jsx(Q,{automationID:a.automationID,errors:a.errors,onQuestionnairePrivacyPolicyURLChange:a.onQuestionnairePrivacyPolicyURLChange,onQuestionnaireStopQuestionsMessageChange:a.onQuestionnaireStopQuestionsMessageChange,pageID:a.pageID,questionnairePrivacyPolicyURL:a.questionnairePrivacyPolicyURL,questionnaireStopQuestionsMessage:a.questionnaireStopQuestionsMessage})]})}function T(a){return H.jsx(b("FBConfirmDialog.react"),{confirmButtonText:i._("Continue"),content:r(a.automationType),onCancel:a.onCancel,onConfirm:a.onConfirm,shown:!0,title:x(a.automationType)})}function U(a){var c;return H.jsxs(H.Fragment,{children:[H.jsx(b("PagesManagerComposerSectionCard.react"),{body:H.jsx(b("PagesMarketingAutomationMessageComposer.react"),{attachmentType:a.attachmentType,automationID:a.automationID,automationType:"saved_reply",ctas:null,errors:a.errors,hideAttachmentSection:!1,hideCTASection:!0,isWelcomeTextIntialized:a.isWelcomeTextIntialized,media:a.media,messageLabel:i._("Text"),onMessageChange:a.onMessageChange,pageID:a.pageID,placeholderText:i._("Write a message..."),showPersonalization:!0,showTimeSection:!1,textLimit:1e3,videoDisabled:!0,welcomeText:(c=(c=a.selectedSavedReply)==null?void 0:c.message)!=null?c:""}),header:i._("Message"),isCollapsible:!1,leftIcon:H.jsx("div",{className:"_6as2 _6as8",children:H.jsx(b("Image.react"),{src:g("561662")})}),subtitle:i._("Customise the message you send.")}),H.jsx(b("PagesManagerComposerSectionCard.react"),{body:H.jsx(b("PagesMarketingAutomationMessageComposer.react"),{attachmentType:null,automationID:a.automationID,ctas:null,errors:a.errors,hideAttachmentSection:!0,hideCTASection:!0,isWelcomeTextIntialized:a.isWelcomeTextIntialized,media:null,messageLabel:i._("Shortcut"),onMessageChange:a.onShortcutChange,pageID:a.pageID,placeholderText:i._("Add a shortcut..."),showPersonalization:!1,showTimeSection:!1,textLimit:80,videoDisabled:!0,welcomeText:(a=(c=a.selectedSavedReply)==null?void 0:c.title)!=null?a:""}),header:i._("Shortcut (required)"),isCollapsible:!1,leftIcon:H.jsx("div",{className:"_6as2 _8nr_",children:H.jsx(b("Image.react"),{src:g("511232")})}),subtitle:i._("Use a shortcut to find this saved reply later and easily insert it into a conversation. Shortcuts must be at least three characters long.")})]})}d=function(a){babelHelpers.inheritsLoose(c,a);function c(){var c,d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=d=a.call.apply(a,[this].concat(f))||this,d.state={saveError:!1,shouldShowErrors:!1,showCustomQuestionsDialog:!1,showComposerErrorsForPreview:!1,isDeleting:!1,isSaving:!1,isSendingPreview:!1,showPreviewSuccessText:!1,showPreviewSendErrors:!1,isMessengerChecked:C(d.props.enabledPlatforms,"MESSENGER"),isIGChecked:C(d.props.enabledPlatforms,"INSTAGRAM_DIRECT"),showAwayTimeRangeDialog:!1,showPlacementUnsetDialog:!1,showQPCDisclaimerDialog:!1},d.$2=function(){d.setState({saveError:!1,shouldShowErrors:!1,isSaving:!1}),b("PagesMarketingAutomationActions").storeState(),b("PagesMarketingAutomationActions").disableIntakeFormSetupExperience(),d.props.automationType==="organic_intake_form"?b("PagesMarketingAutomationActions").updateIsEnabled(!1,"custom_questions"):d.props.automationType==="custom_questions"&&b("PagesMarketingAutomationActions").updateIsEnabled(!1,"organic_intake_form"),d.props.onBack()},d.$3=function(){b("PagesMarketingAutomationActions").updateIsEnabled(!1),d.setState({saveError:!0,shouldShowErrors:!0,isSaving:!1})},d.$4=function(){var a=!0,c="",e=d.props.errors;d.$5();if(e)d.setState({shouldShowErrors:!0}),a=!1,c=e.errorText;else{if(d.state.isMessengerChecked===!1&&d.state.isIGChecked===!1&&D(d.props.enabledPlatforms,d.props.automationType)){d.setState({showPlacementUnsetDialog:!0});return}var f=d.$6();if(f===!1)return;d.setState({isSaving:!0});b("PagesMarketingAutomationActions").updateIsEnabled(!0);b("PagesMarketingAutomationActions").updateWelcomeText(d.props.welcomeText.trim());if(d.props.automationType==="icebreaker")d.$7(d.$2,d.$3);else if(d.props.automationType==="custom_questions"){d.$8();return}else d.props.automationType==="appointment_follow_up"?d.$9(d.$2,d.$3):d.props.automationType==="saved_reply"?d.$10():b("PagesMarketingAutomationStore").getIsDefaultAutomation()?d.$11(d.$2,d.$3):d.$12(d.$2,d.$3)}d.$13(d.props.pageID,d.props.automationID,d.props.automationType,e,a,c)},d.$14=function(){d.setState({showQPCDisclaimerDialog:!0})},d.$5=function(){d.setState({showQPCDisclaimerDialog:!1})},d.$16=function(){d.setState({showCustomQuestionsDialog:!1,isSaving:!1})},d.$15=function(){d.setState({showCustomQuestionsDialog:!1});d.$7(d.$2,d.$3);d.props.icebreakers&&d.props.icebreakers.some(function(a){return a.should_show_in_menu})&&b("PagesMarketingAutomationActions").updateIsCurrentMenuSetByAPI(!1);var a=!0,c="",e=d.props.errors;e&&(d.setState({shouldShowErrors:!0}),a=!1,c=e.errorText);d.$13(d.props.pageID,d.props.automationID,d.props.automationType,e,a,c)},d.$18=function(){var a,c=d.props.initialSelectedSavedReply;a=c==null?void 0:(a=c.image)==null?void 0:a.id;if(c!=null){var e;d.setState({isDeleting:!0});b("PagesDeleteSavedResponseMutation").commit(c.id,function(){d.setState({isDeleting:!1}),d.$17(null)},d.$3);b("PagesMessagingInboxActionLogger").logUpdateSavedReply((e=c==null?void 0:c.message)!=null?e:"","",(e=c==null?void 0:c.title)!=null?e:"","",a,"",null)}},d.$20=function(){new(b("WebFunnelLogger"))("PageMarketingAutomationWebFunnelDefinition").setAction("cancel_click").setActionTag(d.props.automationID).setSessionKey(d.props.pageID).log(),d.setState({saveError:!1}),b("PagesMarketingAutomationActions").revertState(),d.props.automationType!=="saved_reply"&&d.props.onBack()},d.$22=function(){if(d.props.errors){d.setState({showComposerErrorsForPreview:!0});d.$1=window.setTimeout(function(){d.setState({showComposerErrorsForPreview:!1})},3e3);return}d.setState({isSendingPreview:!0});F(d.props.pageID,d.$23,d.$24);d.props.automationType==="organic_intake_form"&&d.logIntakeFormEvent("services_organic_intake_form_setup_click_preview");new(b("WebFunnelLogger"))("PageMarketingAutomationWebFunnelDefinition").setAction("preview_in_messenger_click").setActionTag(d.props.automationID).setSessionKey(d.props.pageID).log()},d.$23=function(){d.setState({showPreviewSuccessText:!0}),d.setState({isSendingPreview:!1}),d.setState({showComposerErrorsForPreview:!1}),d.$1=window.setTimeout(function(){d.setState({showPreviewSuccessText:!1})},3e3)},d.$24=function(){d.setState({showPreviewSendErrors:!0}),d.setState({isSendingPreview:!1}),d.setState({showComposerErrorsForPreview:!1}),d.$1=window.setTimeout(function(){d.setState({showPreviewSendErrors:!1})},3e3)},d.$34=function(){d.setState({showAwayTimeRangeDialog:!1,isSaving:!1})},d.$35=function(){var a=b("PagesMarketingAutomationStore").getAwayTimeZone();if(a==null)return;b("PageSetAwayConfigMutation").commit(a,d.props.pageID,JSON.stringify(b("PagesMarketingAutomationStore").getAwayTimeRanges()),{onSuccess:function(){b("PagesMarketingAutomationActions").updateAwayState(!0)},onFailure:function(){}});b("PagesMarketingAutomationStore").getIsDefaultAutomation()?d.$11(d.$2,d.$3):d.$12(d.$2,d.$3);b("PagesManagerInboxLogger").logAutomatedResponsesSaveClicked(d.props.automationType,!1);d.setState({showAwayTimeRangeDialog:!1,isSaving:!1})},d.$36=function(){d.state.showPlacementUnsetDialog?d.setState({showPlacementUnsetDialog:!1,isSaving:!1}):d.state.showAwayTimeRangeDialog?d.setState({showAwayTimeRangeDialog:!1,isSaving:!1}):d.state.showCustomQuestionsDialog&&d.setState({showCustomQuestionsDialog:!1,isSaving:!1})},d.$37=function(){d.state.showPlacementUnsetDialog?d.$38():d.state.showAwayTimeRangeDialog?d.$35():d.state.showCustomQuestionsDialog&&d.$15()},d.$40=function(a,c){if(!d.props.isWelcomeTextIntialized){b("PagesMarketingAutomationActions").updateIsWelcomeTextInitialized(!0);return}return b("PagesMarketingAutomationActions").updateWelcomeText(c)},d.$41=function(a,c){return b("PagesMarketingAutomationActions").updateAutomatedCheckoutMessages({introMessage:c,questionMessages:d.props.automatedCheckoutMessages.questionMessages,thankYouMessage:d.props.automatedCheckoutMessages.thankYouMessage})},d.$42=function(a,c){var e=d.props.automatedCheckoutMessages.questionMessages.slice(),f=a.answers?a.answers.map(function(a){return a.value}):[];e[c]={answers:f,answerType:(c=a.answerType)!=null?c:k.CUSTOM,message:a.questionMessage,prefillType:"NONE",replyType:"TEXT"};return b("PagesMarketingAutomationActions").updateAutomatedCheckoutMessages({introMessage:d.props.automatedCheckoutMessages.introMessage,questionMessages:e,thankYouMessage:d.props.automatedCheckoutMessages.thankYouMessage})},d.$43=function(a,c){c=c?c.map(function(a){return a.value}):[];b("PagesMarketingAutomationActions").updateAutomatedCheckoutMessages({introMessage:d.props.automatedCheckoutMessages.introMessage,questionMessages:d.props.automatedCheckoutMessages.questionMessages.concat({answers:c,answerType:a,message:b("AdsMessengerPartialAutomatedCreationUtils").getDefaultQuestionMessage(a).toString(),prefillType:"NONE",replyType:"TEXT"}),thankYouMessage:d.props.automatedCheckoutMessages.thankYouMessage})},d.$44=function(a){b("PagesMarketingAutomationActions").updateAutomatedCheckoutMessages({introMessage:d.props.automatedCheckoutMessages.introMessage,questionMessages:d.props.automatedCheckoutMessages.questionMessages.filter(function(b,c){return c!==a}),thankYouMessage:d.props.automatedCheckoutMessages.thankYouMessage})},d.$45=function(a,c){return b("PagesMarketingAutomationActions").updateAutomatedCheckoutMessages({introMessage:d.props.automatedCheckoutMessages.introMessage,questionMessages:d.props.automatedCheckoutMessages.questionMessages,thankYouMessage:c})},d.$46=function(a,c){return b("PagesMarketingAutomationActions").updateOrganicIntakeFormMessages({introMessage:c,questionMessages:d.props.organicIntakeFormMessages.questionMessages,thankYouMessage:d.props.organicIntakeFormMessages.thankYouMessage})},d.$47=function(a,c){var e=d.props.organicIntakeFormMessages.questionMessages.slice();e[a]=c;b("PagesMarketingAutomationActions").updateOrganicIntakeFormMessages({introMessage:d.props.organicIntakeFormMessages.introMessage,questionMessages:e,thankYouMessage:d.props.organicIntakeFormMessages.thankYouMessage});d.$48()},d.$49=function(a,c){var e=d.props.organicIntakeFormMessages.questionMessages.slice(),f=a.answers?a.answers.map(function(a){return a.value}):[];e[c]={answers:f,answerType:(c=a.answerType)!=null?c:k.CUSTOM,message:a.questionMessage,prefillType:"NONE",replyType:"TEXT"};b("PagesMarketingAutomationActions").updateOrganicIntakeFormMessages({introMessage:d.props.organicIntakeFormMessages.introMessage,questionMessages:e,thankYouMessage:d.props.organicIntakeFormMessages.thankYouMessage});d.$48()},d.$50=function(){b("PagesMarketingAutomationActions").toggleQPCPromptQuestion(),d.logIntakeFormEvent("services_organic_intake_form_prompt_question_toggle")},d.$52=function(a,c){b("PagesMarketingAutomationActions").updateSavedReply({message:(a=(a=d.props.selectedSavedReply)==null?void 0:a.message)!=null?a:"",title:c})},d.$53=function(a,c){var e;b("PagesMarketingAutomationActions").updateSavedReply({message:c,title:(e=(e=d.props.selectedSavedReply)==null?void 0:e.title)!=null?e:""});d.$40(a,c)},d.$48=b("debounce")(function(){d.logIntakeFormEvent("services_organic_intake_form_setup_edit_question")},2e3,babelHelpers.assertThisInitialized(d)),d.$54=function(){b("PagesMarketingAutomationActions").updateOrganicIntakeFormMessages({introMessage:d.props.organicIntakeFormMessages.introMessage,questionMessages:d.props.organicIntakeFormMessages.questionMessages.concat({answers:[],answerType:k.CUSTOM,forceEditMode:!0,message:""}),thankYouMessage:d.props.organicIntakeFormMessages.thankYouMessage}),d.logIntakeFormEvent("services_organic_intake_form_setup_add_question")},d.$55=function(a,c){c=c?c.map(function(a){return a.value}):[];b("PagesMarketingAutomationActions").updateOrganicIntakeFormMessages({introMessage:d.props.organicIntakeFormMessages.introMessage,questionMessages:d.props.organicIntakeFormMessages.questionMessages.concat({answers:c,answerType:a,forceEditMode:!0,message:"",prefillType:"NONE",replyType:"TEXT"}),thankYouMessage:d.props.organicIntakeFormMessages.thankYouMessage});d.logIntakeFormEvent("services_organic_intake_form_setup_add_question")},d.$56=function(a){b("PagesMarketingAutomationActions").updateOrganicIntakeFormMessages({introMessage:d.props.organicIntakeFormMessages.introMessage,questionMessages:d.props.organicIntakeFormMessages.questionMessages.filter(function(b,c){return c!==a}),thankYouMessage:d.props.organicIntakeFormMessages.thankYouMessage}),d.logIntakeFormEvent("services_organic_intake_form_setup_remove_question")},d.$57=function(a,c){return b("PagesMarketingAutomationActions").updateOrganicIntakeFormMessages({introMessage:d.props.organicIntakeFormMessages.introMessage,questionMessages:d.props.organicIntakeFormMessages.questionMessages,thankYouMessage:c})},d.$63=function(a){var c,e=d.props.reengagementData.reengagementRules;return b("PagesMarketingAutomationActions").updateAutomatedReengagementData({reengagementMessages:d.props.reengagementData.reengagementMessages,reengagementRules:{mainRules:(c=a.mainRules)!=null?c:e.mainRules,andRules:(c=a.andRules)!=null?c:e.andRules,notRules:(c=a.notRules)!=null?c:e.notRules}})},d.$65=function(a,b){return d.$64(a,{message:b})},d.$66=function(a,b){return d.$64(a,{time:b})},d.$67=function(a,c){if(c===null){var e=d.props.reengagementData.reengagementMessages.slice(),f=e[a];e[a]={triggerTimeMin:f.triggerTimeMin,messageText:f.messageText,ctas:f.ctas,attachment:null,attachmentType:null};return b("PagesMarketingAutomationActions").updateAutomatedReengagementData({reengagementMessages:e,reengagementRules:d.props.reengagementData.reengagementRules})}return d.$64(a,{media:c})},d.$68=function(a,b){return d.$64(a,{mediaType:b})},d.$69=function(a,b){return d.$64(a,{ctas:b})},d.$70=function(){return b("PagesMarketingAutomationActions").updateAutomatedReengagementData({reengagementMessages:d.props.reengagementData.reengagementMessages.concat({triggerTimeMin:0,messageText:"",ctas:[],attachment:null,attachmentType:null}),reengagementRules:d.props.reengagementData.reengagementRules})},d.$71=function(a){return b("PagesMarketingAutomationActions").updateAutomatedReengagementData({reengagementMessages:d.props.reengagementData.reengagementMessages.filter(function(b,c){return c!==a}),reengagementRules:d.props.reengagementData.reengagementRules})},d.$72=function(){b("PagesMarketingAutomationActions").updateShouldShowAdvancedOptions(!d.props.shouldShowAdvancedOptions)},c)||babelHelpers.assertThisInitialized(d)}var d=c.prototype;d.componentWillUnmount=function(){b("PagesManagerAction").setHeaderHeight(0),window.clearTimeout(this.$1)};d.$6=function(){var a=b("PagesMarketingAutomationStore").getAwayTimeZone(),c=b("PagesMarketingAutomationStore").getAwayTimeRanges();if(b("PagesMarketingAutomationStore").getAutomationType()!=="away_message"||a==null||c==null)return!0;c=b("PagesTimeRangeEditorUtilities").getIsRequestTimeInAwayTimeRange(a,c);if(c){this.setState({showAwayTimeRangeDialog:!0});return!1}b("PageSetAwayConfigMutation").commit(a,this.props.pageID,JSON.stringify(b("PagesMarketingAutomationStore").getAwayTimeRanges()),{onSuccess:function(){b("PagesMarketingAutomationActions").updateAwayState(!1)},onFailure:function(){}});return!0};d.$8=function(){b("PagesMarketingAutomationStore").getIsCurrentMenuSetByAPI()&&this.props.icebreakers&&this.props.icebreakers.some(function(a){return a.should_show_in_menu})?this.setState({showCustomQuestionsDialog:!0}):this.$15()};d.$17=function(a){this.setState({saveError:!1,shouldShowErrors:!1,isSaving:!1}),b("SavedResponsesUtils").fetchSavedResponse(this.props.pageID,function(a){b("PagesMarketingAutomationActions").setSavedReplyResponses(a)}),b("PagesMarketingAutomationActions").updateAutomationType("saved_reply"),b("PagesMarketingAutomationActions").updateSelectedSavedReply(a),b("PagesMarketingAutomationActions").storeState()};d.$10=function(){var a=this,c,d=this.props.initialSelectedSavedReply,e=this.props.selectedSavedReply,f=this.props.media&&this.props.media.id!=null?this.props.media.id.toString():null;c=d==null?void 0:(c=d.image)==null?void 0:c.id;if(d!=null){var g;b("PagesEditSavedResponseMutation").commit(d.id,((g=e==null?void 0:e.title)!=null?g:"").trim(),(g=e==null?void 0:e.message)!=null?g:"",f,function(){a.$17(e)},this.$3)}else{b("PagesCreateSavedResponseMutation").commit(this.props.pageID,((g=e==null?void 0:e.title)!=null?g:"").trim(),(g=e==null?void 0:e.message)!=null?g:"",f,null,function(b){if(e!=null){e.id=(b=b==null?void 0:(b=b.page_saved_response_create)==null?void 0:(b=b.new_saved_response)==null?void 0:b.id)!=null?b:""}a.$17(e)},this.$3)}b("PagesMessagingInboxActionLogger").logUpdateSavedReply((g=d==null?void 0:d.message)!=null?g:"",e==null?void 0:e.message,(g=d==null?void 0:d.title)!=null?g:"",e==null?void 0:e.title,c,f,null)};d.$19=function(a,c){c=c?a?"new":"update":"fail";new(b("MessengerAdsConversionFunnelTypedLogger"))().setName("buyer_information_setup_creation").setConversionType("BUYER_INFORMATION").setEventType(this.props.automationType).setEventSubtype(c).setPageID(this.props.pageID).log()};d.$11=function(a,c){var d=this,e={};e.text=this.props.welcomeText.trim();e.trigger_wait_time=E(this.props.automationType);e.trigger_type=this.props.automationType;e.page_id=this.props.pageID;this.props.automationType==="automated_checkout"||this.props.automationType==="buyer_information_form"?e.automated_checkout_data=JSON.stringify(z(!1)):this.props.automationType==="organic_intake_form"&&this.props.isEligibleForIntakeForm&&(e.is_intake_form_enabled=!0,e.automated_checkout_data=JSON.stringify(A(!1)));this.props.reengagementData&&(e.reengagement_notif_data=B(this.props.reengagementData));this.props.media&&(e.attachment=this.props.media);this.props.ctas&&(e.ctas=this.props.ctas);var f=b("PagesMarketingAutomationStore").getServicesReferrerData(),g=f.referrer;f=f.referrerSurface;e.referrer_ui_component=g;e.referrer_ui_surface=f;b("PagesMarketingAutomationCreateMutation").commit({data:e},{onSuccess:function(c){c=(c=c)!=null?(c=c.page_create_automation)!=null?(c=c.automation)!=null?c.id:c:c:c;(d.props.automationType==="automated_checkout"||d.props.automationType==="buyer_information_form")&&d.$19(!!c,!0);c!=null&&c!==""&&(b("PagesMarketingAutomationActions").setDefaultAutomation(!1),b("PagesMarketingAutomationActions").updateAutomationID(c));a()},onFailure:function(){d.props.automationType==="automated_checkout"&&d.$19(!0,!1),c()}})};d.$12=function(a,c){var d=this,e={};e.id=this.props.automationID;e.text=this.props.welcomeText.trim();D(this.props.enabledPlatforms,this.props.automationType)&&(e.platforms=[],this.state.isMessengerChecked===!0&&e.platforms.push("MESSENGER"),this.state.isIGChecked===!0&&e.platforms.push("INSTAGRAM_DIRECT"));this.props.automationType==="automated_checkout"||this.props.automationType==="buyer_information_form"?e.automated_checkout_data=JSON.stringify(z(!1)):this.props.automationType==="organic_intake_form"&&this.props.isEligibleForIntakeForm&&(e.is_intake_form_enabled=!0,e.automated_checkout_data=JSON.stringify(A(!1)));this.props.reengagementData&&(e.reengagement_notif_data=B(this.props.reengagementData));this.props.media?e.attachment=this.props.media:e.remove_attachment=!0;this.props.ctas&&(e.ctas=this.props.ctas);var f=b("PagesMarketingAutomationStore").getServicesReferrerData(),g=f.referrer;f=f.referrerSurface;e.referrer_ui_component=g;e.referrer_ui_surface=f;b("PagesMarketingAutomationUpdateMutation").commit({data:e},{onSuccess:function(c){c=(c=c)!=null?(c=c.page_update_automation)!=null?(c=c.automated_checkout_step_list)!=null?c.id:c:c:c;d.props.automationType==="automated_checkout"&&d.$19(!1,!0);D(d.props.enabledPlatforms,d.props.automationType)&&(e.platforms.length===0&&b("PagesMarketingAutomationActions").updateIsEnabled(!1),b("PagesMarketingAutomationActions").updateEnabledPlatforms(e.platforms));c&&(d.props.automationType==="automated_checkout"?b("PagesMarketingAutomationActions").updatedAutomatedCheckoutStepListID(c):d.props.automationType==="organic_intake_form"&&b("PagesMarketingAutomationActions").updateOrganicIntakeFormStepListID(c));a()},onFailure:function(){d.props.automationType==="automated_checkout"&&d.$19(!1,!1),c()}})};d.$7=function(a,c){if(this.props.icebreakers==null)return;var d=this.props.icebreakers.map(function(a){return{custom_question:a.custom_question.trim(),saved_response:a.saved_response,response_ctas:a.response_ctas,response_media_attachment:a.response_media_attachment,should_show_in_menu:(a=a.should_show_in_menu)!=null?a:!1}}).filter(function(a){return a.custom_question!==""});b("PagesMarketingAutomationActions").updateIcebreakerDemoIndices(y(d));b("PagesMarketingAutomationActions").updateIcebreakers(d);d={icebreaker_question_answer_pairs:d};b("PageUpdateCustomIcebreakersMutation").commit({data:d},{onSuccess:a,onFailure:c})};d.$9=function(a,c){var d=b("PagesMarketingAutomationStore").getFollowUpMessageData();if(d==null)return;d={page_id:this.props.pageID,message_content:d.messageContent,schedule_in_seconds:d.triggerTimeSecs};I({input:d,onCompleted:function(b,d){d?c():a()}})};d.$21=function(a,c){b("PagesManagerAction").setHeaderHeight(c)};d.$25=function(){var a=this.state.isSaving?i._("Saving..."):i._("Save"),c=this.state.showComposerErrorsForPreview&&this.props.errors?i._("You must complete all required fields before previewing your message."):null;this.state.showPreviewSendErrors&&(c=i._("Please try previewing your message again."));var d=this.state.shouldShowErrors&&this.props.errors?this.props.errors.errorText:null;this.state.saveError&&(d=i._("Please try saving your message again."));return H.jsx(b("PagesManagerComposerTopBar.react"),{cancelDisabled:!this.props.hasComposerBeenEdited&&this.props.automationType==="automated_checkout",deleteButtonDisabled:this.state.isDeleting,headerContent:q(this.props.automationType,this.props.automationID),hidePreviewButton:this.props.automationType==="icebreaker"||this.props.automationType==="custom_questions"||this.props.automationType==="mbs_reengagement"||this.props.automationType==="saved_reply"||this.props.automationType==="appointment_reminder"||this.props.automationType==="appointment_follow_up",onCancel:this.$20,onDeleteClick:this.$26(),onPreviewClick:this.$22,onPrimaryClick:this.props.showQPCIcebreakersDisclaimer?this.$14:this.$4,previewButtonText:this.state.isSendingPreview?i._("Preview in Messenger..."):i._("Preview in Messenger"),previewError:c,previewSuccessText:this.state.showPreviewSuccessText?i._("A preview of your message has been sent. You can see it in Messenger."):null,primaryButtonText:a,primaryError:d,sendDisabled:!this.props.hasComposerBeenEdited||this.props.isSendDisabled,showCancelButton:this.props.automationType!=="saved_reply",showDeleteButton:this.props.automationType==="saved_reply"&&this.props.initialSelectedSavedReply!==null})};d.$26=function(){switch(this.props.automationType){case"saved_reply":return this.$18;default:return null}};d.$27=function(){return this.props.automationType==="away_message"||this.props.automationType==="instant_reply"||this.props.automationType==="automated_checkout"||this.props.automationType==="buyer_information_form"||this.props.automationType==="organic_intake_form"};d.$28=function(){return this.props.automationType==="away_message"||this.props.automationType==="instant_reply"||this.props.automationType==="automated_checkout"||this.props.automationType==="buyer_information_form"||this.props.automationType==="organic_intake_form"};d.$29=function(){return this.props.automationType==="mbs_reengagement"||this.props.automationType==="appointment_follow_up"};d.$30=function(){return this.props.automationType==="saved_reply"||this.props.automationType==="automated_checkout"||this.props.automationType==="organic_intake_form"||this.props.automationType==="buyer_information_form"};d.$31=function(){if(this.props.automationType==="away_message")return H.jsx(b("PagesAutomatedResponsesAwayTimeRangeEditorRoot.react"),{pageID:this.props.pageID});else if(this.props.automationType==="instant_reply")return null;else if(this.props.automationType==="organic_intake_form"&&b("enumUtils").coerceFromKey(this.props.qpcConsumerFlow,b("ServicesQPCFlow"))===b("ServicesQPCFlow").ICEBREAKERS)return H.jsxs("div",{className:"_452x _89o0",children:[H.jsx(b("FDSText.react"),{color:"secondary",margin:"_3-8x _3-98",size:"body1",children:w(this.props.automationType)}),H.jsx(b("FDSText.react"),{size:"body2",weight:"bold",children:i._("Frequently asked questions")}),H.jsx(b("FDSText.react"),{color:"secondary",display:"block",size:"body2",children:i._("When questions for potential customers is turned on, a frequently asked question will be added. When the question below is selected, your questions for potential customers will begin in Messenger.")}),H.jsx("div",{className:"_3-8x _2pi4 _2pi9 _8ej0",children:H.jsxs("div",{className:"_2pit _8eix",children:['"',i._("I'm a new customer. How can I find out more about your business?"),'"']})})]});return H.jsx("div",{className:"_452x _89o0 _3-8-",children:H.jsx(b("FDSText.react"),{color:"secondary",size:"body1",children:w(this.props.automationType)})})};d.$32=function(){if(this.props.automationType==="automated_checkout")return H.jsx(b("PagesManagerComposerSectionCard.react"),{body:H.jsx("div",{className:"_89o0 _3-8-",children:H.jsx(b("FDSText.react"),{color:"secondary",size:"body1",children:i._("You can edit the questions and their order.")})}),header:i._("Overview"),isCollapsible:!1,leftIcon:H.jsx("div",{className:"_6as2 _6as7",children:H.jsx(b("Image.react"),{src:g("650922")})}),subtitle:i._("Send a sequence of messages to gather buyer information when customers want to make a purchase.")});else if(this.props.automationType==="buyer_information_form")return H.jsx(b("PagesManagerComposerSectionCard.react"),{header:i._("Overview"),isCollapsible:!1,leftIcon:H.jsx("div",{className:"_6as2 _6as7",children:H.jsx(b("Image.react"),{src:g("650922")})}),subtitle:i._("Send a form to gather customers' information when they want to make a purchase.")});else return null};d.$33=function(){var a=this,c=function(c){b("PagesMarketingAutomationActions").setComposerHasBeenEdited(),a.setState({isMessengerChecked:c})},d=function(c){b("PagesMarketingAutomationActions").setComposerHasBeenEdited(),a.setState({isIGChecked:c})};return H.jsxs("div",{className:"_8o9f",children:[H.jsx("div",{className:"_8o9e",children:H.jsx(b("FDSCheckboxInput.react"),{label:i._("Messenger"),onChange:c,value:this.state.isMessengerChecked})}),H.jsx("div",{className:"_8o9e",children:H.jsx(b("FDSCheckboxInput.react"),{label:i._("Instagram"),onChange:d,value:this.state.isIGChecked})})]})};d.$39=function(){if(this.state.showPlacementUnsetDialog)return"PLATFORMS";else if(this.state.showAwayTimeRangeDialog)return"AWAY_TIME";else if(this.state.showCustomQuestionsDialog)return"CUSTOM_QUESTIONS";return null};d.$38=function(){b("PagesMarketingAutomationStore").getIsDefaultAutomation()?this.$11(this.$2,this.$3):this.$12(this.$2,this.$3),b("PagesManagerInboxLogger").logAutomatedResponsesDisabled(this.props.automationType),this.setState({showPlacementUnsetDialog:!1,isSaving:!1})};d.$51=function(a){b("PagesMarketingAutomationActions").updateQPCPromptQuestion({promptQuestionMessage:a.promptQuestionMessage,promptQuestionStartAnswer:a.promptQuestionStartAnswer,promptQuestionStopAnswer:a.promptQuestionStopAnswer})};d.$13=function(a,c,d,e,f,g){!e&&d==="organic_intake_form"&&this.logIntakeFormEvent("services_organic_intake_form_setup_save_questionnaire"),new(b("WebFunnelLogger"))("PageMarketingAutomationWebFunnelDefinition").setAction("save_click").setActionTag(c).addActionPayload("hasNoErrors",f).addActionPayload("errors",g).addActionPayload("automationType",d).setSessionKey(a).markEnd().log(),new(b("WebFunnelLogger"))("PageMarketingAutomationWebFunnelDefinition").setAction("restart_funnel_after_save").setActionTag(c).setSessionKey(a).addActionPayload("automationType",d).markStart().log(),b("PagesManagerInboxLogger").logAutomatedResponsesSaveClicked(d,!f)};d.$58=function(a,c){b("PagesMarketingAutomationActions").updateQuestionnaireDisqualificationMessage(c)};d.$59=function(a,c){b("PagesMarketingAutomationActions").updateQuestionnaireStopQuestionsMessage(c)};d.$60=function(a,c){b("PagesMarketingAutomationActions").updateQuestionnaireSummaryMessage(c)};d.$61=function(a,c){b("PagesMarketingAutomationActions").updateQuestionnaireReminderMessage(c)};d.$62=function(a){b("PagesMarketingAutomationActions").updateQuestionnairePrivacyPolicyURL(a)};d.logIntakeFormEvent=function(a){var c=b("PagesMarketingAutomationStore").getServicesReferrerData(),d=c.referrer;c=c.referrerSurface;b("ServicesEventsLogger").log(this.props.pageID,a,{referrerUIComponent:d,referrerUISurface:c})};d.$64=function(a,c){var d=this.props.reengagementData.reengagementMessages.slice(),e=d[a];d[a]={triggerTimeMin:c.time!=null?c.time/60:e.triggerTimeMin,messageText:(a=c.message)!=null?a:e.messageText,ctas:(a=c.ctas)!=null?a:e.ctas,attachment:(a=c.media)!=null?a:e.attachment,attachmentType:(a=c.mediaType)!=null?a:e.attachmentType};return b("PagesMarketingAutomationActions").updateAutomatedReengagementData({reengagementMessages:d,reengagementRules:this.props.reengagementData.reengagementRules})};d.render=function(){var a=this.props.automationType==="custom_questions",c=null;switch(this.props.automationType){case"organic_intake_form":c=H.jsx(S,{automationID:this.props.automationID,errors:this.state.shouldShowErrors?this.props.errors:null,isQPCPromptQuestionEnabled:this.props.isQPCPromptQuestionEnabled,isWelcomeTextInitialized:this.props.isWelcomeTextIntialized,oldOnAddQuestion:this.$54,oldOnQuestionMessageChange:this.$47,onAddQuestion:this.$55,onClickQPCAdvancedOptionsLink:this.$72,onIntroMessageChange:this.$46,onPromptQuestionChange:this.$51,onQuestionMessageChange:this.$49,onQuestionnairePrivacyPolicyURLChange:this.$62,onQuestionnaireReminderMessageChange:this.$61,onQuestionnaireStopQuestionsMessageChange:this.$59,onRemoveQuestion:this.$56,onThankYouMessageChange:this.$57,onToggleQPCPromptQuestion:this.$50,organicIntakeFormMessages:this.props.organicIntakeFormMessages,pageID:this.props.pageID,qpcPromptQuestion:this.props.qpcPromptQuestion,questionnairePrivacyPolicyURL:this.props.questionnairePrivacyPolicyURL,questionnaireReminderMessage:this.props.questionnaireReminderMessage,questionnaireStopQuestionsMessage:this.props.questionnaireStopQuestionsMessage,shouldHideAttachment:this.$27(),shouldHideCTA:this.$28(),shouldShowAdvancedOptions:this.props.shouldShowAdvancedOptions});break;case"automated_checkout":case"buyer_information_form":c=H.jsx(O,{automatedCheckoutMessages:this.props.automatedCheckoutMessages,automationID:this.props.automationID,automationType:this.props.automationType,errors:this.state.shouldShowErrors?this.props.errors:null,isWelcomeTextInitialized:this.props.isWelcomeTextIntialized,onAddQuestion:this.$43,onIntroMessageChange:this.$41,onQuestionMessageChange:this.$42,onQuestionnaireDisqualificationMessageChange:this.$58,onQuestionnairePrivacyPolicyURLChange:this.$62,onQuestionnaireReminderMessageChange:this.$61,onQuestionnaireStopQuestionsMessageChange:this.$59,onQuestionnaireSummaryMessageChange:this.$60,onRemoveQuestion:this.$44,onThankYouMessageChange:this.$45,pageID:this.props.pageID,questionnaireDisqualificationMessage:this.props.questionnaireDisqualificationMessage,questionnairePrivacyPolicyURL:this.props.questionnairePrivacyPolicyURL,questionnaireReminderMessage:this.props.questionnaireReminderMessage,questionnaireStopQuestionsMessage:this.props.questionnaireStopQuestionsMessage,questionnaireSummaryMessage:this.props.questionnaireSummaryMessage,shouldHideAttachment:this.$27(),shouldHideCTA:this.$28(),shouldShowAdvancedOptions:this.props.shouldShowAdvancedOptions});break;case"icebreaker":c=H.jsx(b("IcebreakerFreeTextEditor.react"),{icebreakers:this.props.icebreakers||[],isInboxCombinedCustomQuestionTest:!1,pageID:this.props.pageID});break;case"custom_questions":c=H.jsx(b("IcebreakerFreeTextEditor.react"),{icebreakers:this.props.icebreakers||[],isInboxCombinedCustomQuestionTest:!0,pageID:this.props.pageID});break;case"mbs_reengagement":c=H.jsx(M,{automationID:this.props.automationID,data:this.props.reengagementData,onAddMessage:this.$70,onIndexedCTAChange:this.$69,onIndexedMediaChange:this.$67,onIndexedMediaTypeChange:this.$68,onIndexedTimeChange:this.$66,onMessageChange:this.$65,onRemoveMessage:this.$71,onRulesChange:this.$63,pageID:this.props.pageID});break;case"appointment_follow_up":c=H.jsx(b("AppointmentFollowUpMessageEditor.react"),{followUpMessageData:this.props.followUpMessageData,pageID:this.props.pageID});break;case"saved_reply":c=H.jsx(U,{attachmentType:this.props.attachmentType,automationID:this.props.automationID,ctas:this.props.ctas,errors:this.state.shouldShowErrors||this.state.showComposerErrorsForPreview?null:this.props.errors,isWelcomeTextIntialized:this.props.isWelcomeTextIntialized,media:this.props.media,onMessageChange:this.$53,onShortcutChange:this.$52,pageID:this.props.pageID,selectedSavedReply:this.props.selectedSavedReply});break;default:c=H.jsx(b("PagesManagerComposerSectionCard.react"),{body:H.jsx(b("PagesMarketingAutomationMessageComposer.react"),{attachmentType:this.props.attachmentType,automationID:this.props.automationID,ctas:this.props.ctas,errors:this.state.shouldShowErrors||this.state.showComposerErrorsForPreview?this.props.errors:null,hideAttachmentSection:this.$27(),hideCTASection:this.$28(),isWelcomeTextIntialized:this.props.isWelcomeTextIntialized,media:this.props.media,onMessageChange:this.$40,pageID:this.props.pageID,showPersonalization:!0,showTimeSection:this.$29(),welcomeText:this.props.welcomeText}),header:i._("Message"),isCollapsible:!1,leftIcon:H.jsx("div",{className:"_6as2 _6as8",children:H.jsx(b("Image.react"),{src:g("561662")})}),subtitle:i._("Customise the message that you send.")})}var d=this.$29()||this.$30()?null:H.jsx(b("PagesManagerComposerSectionCard.react"),{body:this.$31(),header:i._("Timing"),isCollapsible:!1,leftIcon:H.jsx("div",{className:"_6as2 _6as7",children:H.jsx(b("Image.react"),{src:g("583805")})}),subtitle:v(this.props.automationType,this.props.pageName)}),e=this.$32(),f=D(this.props.enabledPlatforms,this.props.automationType)?H.jsx(b("PagesManagerComposerSectionCard.react"),{body:this.$33(),header:i._("Platform"),isCollapsible:!1,leftIcon:H.jsx("div",{className:"_6as2 _8o9d",children:H.jsx(b("Image.react"),{src:g("532776")})}),subtitle:u(this.props.automationType,this.props.pageName)}):null,h=this.props.welcomeText;if(this.props.automationType==="automated_checkout")h=this.props.automatedCheckoutMessages.introMessage;else if(this.props.automationType==="appointment_follow_up"){var j=b("PagesMarketingAutomationStore").getFollowUpMessageData();h=j?j.messageContent:h}j=null;this.props.automationType==="organic_intake_form"&&this.props.isEligibleForIntakeForm?j=this.props.organicIntakeFormMessages:this.props.automationType==="automated_checkout"&&(j=this.props.automatedCheckoutMessages);return H.jsxs("div",{className:"_6arp",children:[H.jsx(b("ResponsiveBlock.react"),{onResize:this.$21,children:this.$25()}),this.state.showQPCDisclaimerDialog?H.jsx(T,{automationType:this.props.automationType,onCancel:this.$5,onConfirm:this.$4}):null,H.jsxs("div",{className:"_6arq"+(a?"":" _8k88"),style:{height:this.props.height},children:[H.jsxs("div",{className:(a?"":"_6as1")+(a?" _8k87":""),children:[e,f,d,c]}),H.jsx("div",{className:(a?"":"_2f4z")+(a?" _8k86":""),children:this.props.automationType==="mbs_reengagement"?H.jsx(b("PagesMessengerReengagementPreview.react"),{pageID:this.props.pageID,pageName:this.props.pageName,pageProfileUrl:this.props.pageProfileUrl,reengagementMessages:this.props.reengagementData.reengagementMessages}):this.props.automationType==="custom_questions"?H.jsx(b("PagesMessengerCustomQuestionsPreview.react"),{icebreakers:(e=this.props.demoIcebreakers)!=null?e:[],menuItems:this.props.icebreakers&&this.props.icebreakers.filter(function(a){return a.custom_question.length>0&&Boolean(a.should_show_in_menu)})||[],pageID:this.props.pageID,pageName:this.props.pageName,pageProfileUrl:this.props.pageProfileUrl,text:this.props.welcomeText}):H.jsx(b("PagesMessengerPreview.react"),{attachmentType:this.props.attachmentType,automationType:this.props.automationType,ctas:this.props.ctas,ghostText:p(this.props.automationType,this.props.pageName),ghostTextLocation:G(this.props.automationType)?"bottom":"top",icebreakers:this.props.demoIcebreakers,media:this.props.media,pageID:this.props.pageID,pageName:this.props.pageName,pageProfileUrl:this.props.pageProfileUrl,qpcPromptQuestion:this.props.isQPCPromptQuestionEnabled?this.props.qpcPromptQuestion:null,questionnaireMessages:j,text:h})}),D(this.props.enabledPlatforms,this.props.automationType)?H.jsx(K,{isShown:this.state.showPlacementUnsetDialog||this.state.showAwayTimeRangeDialog||this.state.showCustomQuestionsDialog,modalPurpose:this.$39(),onCancelClick:this.$36,onConfirmClick:this.$37}):null,H.jsx(J,{isShown:this.state.showAwayTimeRangeDialog,onCancelClick:this.$34,onConfirmClick:this.$35}),H.jsx(L,{isShown:this.state.showCustomQuestionsDialog,onCancelClick:this.$16,onConfirmClick:this.$15})]})]})};return c}(H.PureComponent);e.exports=d}),null);
__d("PagesMarketingAutomationEnableDisplay.react",["cx","fbt","FDSText.react","PagesMarketingAutomationUtils","React"],(function(a,b,c,d,e,f,g,h){"use strict";var i=b("PagesMarketingAutomationUtils").getPlatformStatus,j=b("PagesMarketingAutomationUtils").getShouldShowIGDirectAutomatedResponse,k=b("React");a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.$1=function(){var a=this.props.isEnabled===!0?h._("On"):h._("Off"),c=j(this.props.enabledPlatforms,this.props.automationType),d=!1;this.props.enabledPlatforms!=null&&(this.props.enabledPlatforms.length!==0&&(d=!0));return k.jsxs("div",{className:(!c||d===!1?"_452x":"")+(c&&d===!0?" _8prl":""),children:[k.jsx("span",{className:"_2qy-"+(this.props.isEnabled?"":" _2qy_")+(this.props.isEnabled?" _2qz0":"")}),k.jsx(b("FDSText.react"),{color:"secondary",size:"header2",children:a})]})};d.$2=function(){if(this.props.enabledPlatforms!=null){if(this.props.enabledPlatforms.length===0)return null;var a=this.props.enabledPlatforms,c=i(a,"MESSENGER");a=i(a,"INSTAGRAM_DIRECT");var d=h._("Sent on Instagram and Messenger");a===!0&&c===!1?d=h._("Sent only on Instagram"):a===!1&&c===!0&&(d=h._("Sent only in Messenger"));return k.jsx("div",{children:k.jsx("div",{className:"_8khs",children:k.jsx(b("FDSText.react"),{color:"secondary",size:"body",children:d})})})}return null};d.render=function(){return k.jsxs("div",{children:[this.$1(),j(this.props.enabledPlatforms,this.props.automationType)?this.$2():null]})};return c}(k.PureComponent);e.exports=a}),null);